!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.universe=t():e.universe=t()}(window,function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/build/",n(n.s=7)}([function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t){(function(t){e.exports=t}).call(this,{})},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";
/*!
 * set-location-hash.js | MIT (c) Shinnosuke Watanabe
 * https://github.com/shinnn/set-location-hash.js
*/var o;if("function"==typeof history.pushState&&"function"==typeof history.replaceState)o=function(e,t){var n;n=(t=t||{force:!1,replace:!1}).replace?"replaceState":"pushState";var o="#"+e;return(location.hash!==o||t.force)&&history[n](null,document.title,location.pathname+location.search+o),location.href};else{var i=document.body,r=document.documentElement;o=function(e){var t=i.scrollTop||r.scrollTop;return location.hash=""+e,i.scrollTop=t,r.scrollTop=t,location.href}}e.exports=o},function(e,t,n){var o=n(16),i=n(15),r=n(14),s=n(13),a=n(12),l=n(11),u=n(10);u.alea=o,u.xor128=i,u.xorwow=r,u.xorshift7=s,u.xor4096=a,u.tychei=l,e.exports=u},function(e,t,n){var o,i,r;i=[],void 0===(r="function"==typeof(o=function(){var e;function t(e){try{delete window[e]}catch(t){window[e]=null}}function n(n,o){return new Promise(function(i,r){if("object"==typeof n&&(n=(o=n).url),o||(o={}),n){var s=document.createElement("script"),a=o.insertInto?document.querySelector(o.insertInto):o.inBody?document.body:document.head;if(a){var l=o.attrs,u=o.removeScript,c=o.callBackName;for(var d in l)Object.prototype.hasOwnProperty.call(l,d)&&s.setAttribute(d,l[d]);c?window[c]=function(n){n||(n=u?e:s),o.dontRemoveCallBack||t(c),u&&a.removeChild(s),i(n||u?e:s)}:s.addEventListener("load",function(){u&&a.removeChild(s),i(u?e:s)}),s.addEventListener("error",function(){a.removeChild(s),r("Error: loading script")}),s.src=n,a.appendChild(s)}else r("Error: no DOM element to append script")}else r("Error: no script url")})}return n.deleteFromGlobal=t,n.all=function(){return arguments.length?Promise.all(Array.prototype.slice.call(arguments).map(function(e){return Array.isArray(e)?n.apply(null,e):n(e)})):Promise.reject(new Error("No files or no file configs"))},n})?o.apply(t,i):o)||(e.exports=r)},function(e,t){},function(e,t,n){"use strict";function o(e,t){var n=e.__state.conversionName.toString(),o=Math.round(e.r),i=Math.round(e.g),r=Math.round(e.b),s=e.a,a=Math.round(e.h),l=e.s.toFixed(1),u=e.v.toFixed(1);if(t||"THREE_CHAR_HEX"===n||"SIX_CHAR_HEX"===n){for(var c=e.hex.toString(16);c.length<6;)c="0"+c;return"#"+c}return"CSS_RGB"===n?"rgb("+o+","+i+","+r+")":"CSS_RGBA"===n?"rgba("+o+","+i+","+r+","+s+")":"HEX"===n?"0x"+e.hex.toString(16):"RGB_ARRAY"===n?"["+o+","+i+","+r+"]":"RGBA_ARRAY"===n?"["+o+","+i+","+r+","+s+"]":"RGB_OBJ"===n?"{r:"+o+",g:"+i+",b:"+r+"}":"RGBA_OBJ"===n?"{r:"+o+",g:"+i+",b:"+r+",a:"+s+"}":"HSV_OBJ"===n?"{h:"+a+",s:"+l+",v:"+u+"}":"HSVA_OBJ"===n?"{h:"+a+",s:"+l+",v:"+u+",a:"+s+"}":"unknown format"}n.r(t);var i=Array.prototype.forEach,r=Array.prototype.slice,s={BREAK:{},extend:function(e){return this.each(r.call(arguments,1),function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(n){this.isUndefined(t[n])||(e[n]=t[n])}.bind(this))},this),e},defaults:function(e){return this.each(r.call(arguments,1),function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(n){this.isUndefined(e[n])&&(e[n]=t[n])}.bind(this))},this),e},compose:function(){var e=r.call(arguments);return function(){for(var t=r.call(arguments),n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},each:function(e,t,n){if(e)if(i&&e.forEach&&e.forEach===i)e.forEach(t,n);else if(e.length===e.length+0){var o,r=void 0;for(r=0,o=e.length;r<o;r++)if(r in e&&t.call(n,e[r],r)===this.BREAK)return}else for(var s in e)if(t.call(n,e[s],s)===this.BREAK)return},defer:function(e){setTimeout(e,0)},debounce:function(e,t,n){var o=void 0;return function(){var i=this,r=arguments;var s=n||!o;clearTimeout(o),o=setTimeout(function(){o=null,n||e.apply(i,r)},t),s&&e.apply(i,r)}},toArray:function(e){return e.toArray?e.toArray():r.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return isNaN(e)}),isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return!1===e||!0===e},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)}},a=[{litmus:s.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:o},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:o},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:o},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:o}}},{litmus:s.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:s.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:s.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(s.isNumber(e.r)&&s.isNumber(e.g)&&s.isNumber(e.b)&&s.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(s.isNumber(e.r)&&s.isNumber(e.g)&&s.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(s.isNumber(e.h)&&s.isNumber(e.s)&&s.isNumber(e.v)&&s.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(s.isNumber(e.h)&&s.isNumber(e.s)&&s.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],l=void 0,u=void 0,c=function(){u=!1;var e=arguments.length>1?s.toArray(arguments):arguments[0];return s.each(a,function(t){if(t.litmus(e))return s.each(t.conversions,function(t,n){if(l=t.read(e),!1===u&&!1!==l)return u=l,l.conversionName=n,l.conversion=t,s.BREAK}),s.BREAK}),u},d=void 0,h={hsv_to_rgb:function(e,t,n){var o=Math.floor(e/60)%6,i=e/60-Math.floor(e/60),r=n*(1-t),s=n*(1-i*t),a=n*(1-(1-i)*t),l=[[n,a,r],[s,n,r],[r,n,a],[r,s,n],[a,r,n],[n,r,s]][o];return{r:255*l[0],g:255*l[1],b:255*l[2]}},rgb_to_hsv:function(e,t,n){var o=Math.min(e,t,n),i=Math.max(e,t,n),r=i-o,s=void 0;return 0===i?{h:NaN,s:0,v:0}:(s=e===i?(t-n)/r:t===i?2+(n-e)/r:4+(e-t)/r,(s/=6)<0&&(s+=1),{h:360*s,s:r/i,v:i/255})},rgb_to_hex:function(e,t,n){var o=this.hex_with_component(0,2,e);return o=this.hex_with_component(o,1,t),o=this.hex_with_component(o,0,n)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(e,t,n){return n<<(d=8*t)|e&~(255<<d)}},p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},g=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),m=function e(t,n,o){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var r=Object.getPrototypeOf(t);return null===r?void 0:e(r,n,o)}if("value"in i)return i.value;var s=i.get;return void 0!==s?s.call(o):void 0},b=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},_=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},v=function(){function e(){if(f(this,e),this.__state=c.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return g(e,[{key:"toString",value:function(){return o(this)}},{key:"toHexString",value:function(){return o(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),e}();function y(e,t,n){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space?this.__state[t]:(v.recalculateRGB(this,t,n),this.__state[t])},set:function(e){"RGB"!==this.__state.space&&(v.recalculateRGB(this,t,n),this.__state.space="RGB"),this.__state[t]=e}})}function w(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space?this.__state[t]:(v.recalculateHSV(this),this.__state[t])},set:function(e){"HSV"!==this.__state.space&&(v.recalculateHSV(this),this.__state.space="HSV"),this.__state[t]=e}})}v.recalculateRGB=function(e,t,n){if("HEX"===e.__state.space)e.__state[t]=h.component_from_hex(e.__state.hex,n);else{if("HSV"!==e.__state.space)throw new Error("Corrupted color state");s.extend(e.__state,h.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}},v.recalculateHSV=function(e){var t=h.rgb_to_hsv(e.r,e.g,e.b);s.extend(e.__state,{s:t.s,v:t.v}),s.isNaN(t.h)?s.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=t.h},v.COMPONENTS=["r","g","b","h","s","v","hex","a"],y(v.prototype,"r",2),y(v.prototype,"g",1),y(v.prototype,"b",0),w(v.prototype,"h"),w(v.prototype,"s"),w(v.prototype,"v"),Object.defineProperty(v.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(v.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=h.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var k=function(){function e(t,n){f(this,e),this.initialValue=t[n],this.domElement=document.createElement("div"),this.object=t,this.property=n,this.__onChange=void 0,this.__onFinishChange=void 0}return g(e,[{key:"onChange",value:function(e){return this.__onChange=e,this}},{key:"onFinishChange",value:function(e){return this.__onFinishChange=e,this}},{key:"setValue",value:function(e){return this.object[this.property]=e,this.__onChange&&this.__onChange.call(this,e),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),e}(),x={};s.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(e,t){s.each(e,function(e){x[e]=t})});var C=/(\d+(\.\d+)?)px/;function E(e){if("0"===e||s.isUndefined(e))return 0;var t=e.match(C);return s.isNull(t)?0:parseFloat(t[1])}var M={makeSelectable:function(e,t){void 0!==e&&void 0!==e.style&&(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,n){var o=n,i=t;s.isUndefined(i)&&(i=!0),s.isUndefined(o)&&(o=!0),e.style.position="absolute",i&&(e.style.left=0,e.style.right=0),o&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,n,o){var i=n||{},r=x[t];if(!r)throw new Error("Event type "+t+" not supported.");var a=document.createEvent(r);switch(r){case"MouseEvents":var l=i.x||i.clientX||0,u=i.y||i.clientY||0;a.initMouseEvent(t,i.bubbles||!1,i.cancelable||!0,window,i.clickCount||1,0,0,l,u,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var c=a.initKeyboardEvent||a.initKeyEvent;s.defaults(i,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),c(t,i.bubbles||!1,i.cancelable,window,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.keyCode,i.charCode);break;default:a.initEvent(t,i.bubbles||!1,i.cancelable||!0)}s.defaults(a,o),e.dispatchEvent(a)},bind:function(e,t,n,o){var i=o||!1;return e.addEventListener?e.addEventListener(t,n,i):e.attachEvent&&e.attachEvent("on"+t,n),M},unbind:function(e,t,n,o){var i=o||!1;return e.removeEventListener?e.removeEventListener(t,n,i):e.detachEvent&&e.detachEvent("on"+t,n),M},addClass:function(e,t){if(void 0===e.className)e.className=t;else if(e.className!==t){var n=e.className.split(/ +/);-1===n.indexOf(t)&&(n.push(t),e.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return M},removeClass:function(e,t){if(t)if(e.className===t)e.removeAttribute("class");else{var n=e.className.split(/ +/),o=n.indexOf(t);-1!==o&&(n.splice(o,1),e.className=n.join(" "))}else e.className=void 0;return M},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var t=getComputedStyle(e);return E(t["border-left-width"])+E(t["border-right-width"])+E(t["padding-left"])+E(t["padding-right"])+E(t.width)},getHeight:function(e){var t=getComputedStyle(e);return E(t["border-top-width"])+E(t["border-bottom-width"])+E(t["padding-top"])+E(t["padding-bottom"])+E(t.height)},getOffset:function(e){var t=e,n={left:0,top:0};if(t.offsetParent)do{n.left+=t.offsetLeft,n.top+=t.offsetTop,t=t.offsetParent}while(t);return n},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},A=function(e){function t(e,n){f(this,t);var o=_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),i=o;return o.__prev=o.getValue(),o.__checkbox=document.createElement("input"),o.__checkbox.setAttribute("type","checkbox"),M.bind(o.__checkbox,"change",function(){i.setValue(!i.__prev)},!1),o.domElement.appendChild(o.__checkbox),o.updateDisplay(),o}return b(t,k),g(t,[{key:"setValue",value:function(e){var n=m(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),n}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),m(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(),O=function(e){function t(e,n,o){f(this,t);var i=_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),r=o,a=i;if(i.__select=document.createElement("select"),s.isArray(r)){var l={};s.each(r,function(e){l[e]=e}),r=l}return s.each(r,function(e,t){var n=document.createElement("option");n.innerHTML=t,n.setAttribute("value",e),a.__select.appendChild(n)}),i.updateDisplay(),M.bind(i.__select,"change",function(){var e=this.options[this.selectedIndex].value;a.setValue(e)}),i.domElement.appendChild(i.__select),i}return b(t,k),g(t,[{key:"setValue",value:function(e){var n=m(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),n}},{key:"updateDisplay",value:function(){return M.isActive(this.__select)?this:(this.__select.value=this.getValue(),m(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this))}}]),t}(),S=function(e){function t(e,n){f(this,t);var o=_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),i=o;function r(){i.setValue(i.__input.value)}return o.__input=document.createElement("input"),o.__input.setAttribute("type","text"),M.bind(o.__input,"keyup",r),M.bind(o.__input,"change",r),M.bind(o.__input,"blur",function(){i.__onFinishChange&&i.__onFinishChange.call(i,i.getValue())}),M.bind(o.__input,"keydown",function(e){13===e.keyCode&&this.blur()}),o.updateDisplay(),o.domElement.appendChild(o.__input),o}return b(t,k),g(t,[{key:"updateDisplay",value:function(){return M.isActive(this.__input)||(this.__input.value=this.getValue()),m(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}();function L(e){var t=e.toString();return t.indexOf(".")>-1?t.length-t.indexOf(".")-1:0}var R=function(e){function t(e,n,o){f(this,t);var i=_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),r=o||{};return i.__min=r.min,i.__max=r.max,i.__step=r.step,s.isUndefined(i.__step)?0===i.initialValue?i.__impliedStep=1:i.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(i.initialValue))/Math.LN10))/10:i.__impliedStep=i.__step,i.__precision=L(i.__impliedStep),i}return b(t,k),g(t,[{key:"setValue",value:function(e){var n=e;return void 0!==this.__min&&n<this.__min?n=this.__min:void 0!==this.__max&&n>this.__max&&(n=this.__max),void 0!==this.__step&&n%this.__step!=0&&(n=Math.round(n/this.__step)*this.__step),m(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,n)}},{key:"min",value:function(e){return this.__min=e,this}},{key:"max",value:function(e){return this.__max=e,this}},{key:"step",value:function(e){return this.__step=e,this.__impliedStep=e,this.__precision=L(e),this}}]),t}();var T=function(e){function t(e,n,o){f(this,t);var i=_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,o));i.__truncationSuspended=!1;var r=i,a=void 0;function l(){r.__onFinishChange&&r.__onFinishChange.call(r,r.getValue())}function u(e){var t=a-e.clientY;r.setValue(r.getValue()+t*r.__impliedStep),a=e.clientY}function c(){M.unbind(window,"mousemove",u),M.unbind(window,"mouseup",c),l()}return i.__input=document.createElement("input"),i.__input.setAttribute("type","text"),M.bind(i.__input,"change",function(){var e=parseFloat(r.__input.value);s.isNaN(e)||r.setValue(e)}),M.bind(i.__input,"blur",function(){l()}),M.bind(i.__input,"mousedown",function(e){M.bind(window,"mousemove",u),M.bind(window,"mouseup",c),a=e.clientY}),M.bind(i.__input,"keydown",function(e){13===e.keyCode&&(r.__truncationSuspended=!0,this.blur(),r.__truncationSuspended=!1,l())}),i.updateDisplay(),i.domElement.appendChild(i.__input),i}return b(t,R),g(t,[{key:"updateDisplay",value:function(){var e,n,o;return this.__input.value=this.__truncationSuspended?this.getValue():(e=this.getValue(),n=this.__precision,o=Math.pow(10,n),Math.round(e*o)/o),m(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}();function P(e,t,n,o,i){return o+(e-t)/(n-t)*(i-o)}var N=function(e){function t(e,n,o,i,r){f(this,t);var s=_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,{min:o,max:i,step:r})),a=s;function l(e){e.preventDefault();var t=a.__background.getBoundingClientRect();return a.setValue(P(e.clientX,t.left,t.right,a.__min,a.__max)),!1}function u(){M.unbind(window,"mousemove",l),M.unbind(window,"mouseup",u),a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}function c(e){var t=e.touches[0].clientX,n=a.__background.getBoundingClientRect();a.setValue(P(t,n.left,n.right,a.__min,a.__max))}function d(){M.unbind(window,"touchmove",c),M.unbind(window,"touchend",d),a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}return s.__background=document.createElement("div"),s.__foreground=document.createElement("div"),M.bind(s.__background,"mousedown",function(e){document.activeElement.blur(),M.bind(window,"mousemove",l),M.bind(window,"mouseup",u),l(e)}),M.bind(s.__background,"touchstart",function(e){if(1!==e.touches.length)return;M.bind(window,"touchmove",c),M.bind(window,"touchend",d),c(e)}),M.addClass(s.__background,"slider"),M.addClass(s.__foreground,"slider-fg"),s.updateDisplay(),s.__background.appendChild(s.__foreground),s.domElement.appendChild(s.__background),s}return b(t,R),g(t,[{key:"updateDisplay",value:function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",m(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(),V=function(e){function t(e,n,o){f(this,t);var i=_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),r=i;return i.__button=document.createElement("div"),i.__button.innerHTML=void 0===o?"Fire":o,M.bind(i.__button,"click",function(e){return e.preventDefault(),r.fire(),!1}),M.addClass(i.__button,"button"),i.domElement.appendChild(i.__button),i}return b(t,k),g(t,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),t}(),B=function(e){function t(e,n){f(this,t);var o=_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));o.__color=new v(o.getValue()),o.__temp=new v(0);var i=o;o.domElement=document.createElement("div"),M.makeSelectable(o.domElement,!1),o.__selector=document.createElement("div"),o.__selector.className="selector",o.__saturation_field=document.createElement("div"),o.__saturation_field.className="saturation-field",o.__field_knob=document.createElement("div"),o.__field_knob.className="field-knob",o.__field_knob_border="2px solid ",o.__hue_knob=document.createElement("div"),o.__hue_knob.className="hue-knob",o.__hue_field=document.createElement("div"),o.__hue_field.className="hue-field",o.__input=document.createElement("input"),o.__input.type="text",o.__input_textShadow="0 1px 1px ",M.bind(o.__input,"keydown",function(e){13===e.keyCode&&p.call(this)}),M.bind(o.__input,"blur",p),M.bind(o.__selector,"mousedown",function(){M.addClass(this,"drag").bind(window,"mouseup",function(){M.removeClass(i.__selector,"drag")})}),M.bind(o.__selector,"touchstart",function(){M.addClass(this,"drag").bind(window,"touchend",function(){M.removeClass(i.__selector,"drag")})});var r,a=document.createElement("div");function l(e){m(e),M.bind(window,"mousemove",m),M.bind(window,"touchmove",m),M.bind(window,"mouseup",d),M.bind(window,"touchend",d)}function u(e){b(e),M.bind(window,"mousemove",b),M.bind(window,"touchmove",b),M.bind(window,"mouseup",h),M.bind(window,"touchend",h)}function d(){M.unbind(window,"mousemove",m),M.unbind(window,"touchmove",m),M.unbind(window,"mouseup",d),M.unbind(window,"touchend",d),g()}function h(){M.unbind(window,"mousemove",b),M.unbind(window,"touchmove",b),M.unbind(window,"mouseup",h),M.unbind(window,"touchend",h),g()}function p(){var e=c(this.value);!1!==e?(i.__color.__state=e,i.setValue(i.__color.toOriginal())):this.value=i.__color.toString()}function g(){i.__onFinishChange&&i.__onFinishChange.call(i,i.__color.toOriginal())}function m(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=i.__saturation_field.getBoundingClientRect(),n=e.touches&&e.touches[0]||e,o=n.clientX,r=n.clientY,s=(o-t.left)/(t.right-t.left),a=1-(r-t.top)/(t.bottom-t.top);return a>1?a=1:a<0&&(a=0),s>1?s=1:s<0&&(s=0),i.__color.v=a,i.__color.s=s,i.setValue(i.__color.toOriginal()),!1}function b(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=i.__hue_field.getBoundingClientRect(),n=1-((e.touches&&e.touches[0]||e).clientY-t.top)/(t.bottom-t.top);return n>1?n=1:n<0&&(n=0),i.__color.h=360*n,i.setValue(i.__color.toOriginal()),!1}return s.extend(o.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),s.extend(o.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:o.__field_knob_border+(o.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),s.extend(o.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),s.extend(o.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),s.extend(a.style,{width:"100%",height:"100%",background:"none"}),I(a,"top","rgba(0,0,0,0)","#000"),s.extend(o.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),(r=o.__hue_field).style.background="",r.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",r.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",r.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",r.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",r.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",s.extend(o.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:o.__input_textShadow+"rgba(0,0,0,0.7)"}),M.bind(o.__saturation_field,"mousedown",l),M.bind(o.__saturation_field,"touchstart",l),M.bind(o.__field_knob,"mousedown",l),M.bind(o.__field_knob,"touchstart",l),M.bind(o.__hue_field,"mousedown",u),M.bind(o.__hue_field,"touchstart",u),o.__saturation_field.appendChild(a),o.__selector.appendChild(o.__field_knob),o.__selector.appendChild(o.__saturation_field),o.__selector.appendChild(o.__hue_field),o.__hue_field.appendChild(o.__hue_knob),o.domElement.appendChild(o.__input),o.domElement.appendChild(o.__selector),o.updateDisplay(),o}return b(t,k),g(t,[{key:"updateDisplay",value:function(){var e=c(this.getValue());if(!1!==e){var t=!1;s.each(v.COMPONENTS,function(n){if(!s.isUndefined(e[n])&&!s.isUndefined(this.__color.__state[n])&&e[n]!==this.__color.__state[n])return t=!0,{}},this),t&&s.extend(this.__color.__state,e)}s.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var n=this.__color.v<.5||this.__color.s>.5?255:0,o=255-n;s.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+n+","+n+","+n+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,I(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),s.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+n+","+n+","+n+")",textShadow:this.__input_textShadow+"rgba("+o+","+o+","+o+",.7)"})}}]),t}(),j=["-moz-","-o-","-webkit-","-ms-",""];function I(e,t,n,o){e.style.background="",s.each(j,function(i){e.style.cssText+="background: "+i+"linear-gradient("+t+", "+n+" 0%, "+o+" 100%); "})}var F=function(e,t){var n=t||document,o=document.createElement("style");o.type="text/css",o.innerHTML=e;var i=n.getElementsByTagName("head")[0];try{i.appendChild(o)}catch(e){}},H=function(e,t){var n=e[t];return s.isArray(arguments[2])||s.isObject(arguments[2])?new O(e,t,arguments[2]):s.isNumber(n)?s.isNumber(arguments[2])&&s.isNumber(arguments[3])?s.isNumber(arguments[4])?new N(e,t,arguments[2],arguments[3],arguments[4]):new N(e,t,arguments[2],arguments[3]):s.isNumber(arguments[4])?new T(e,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new T(e,t,{min:arguments[2],max:arguments[3]}):s.isString(n)?new S(e,t):s.isFunction(n)?new V(e,t,""):s.isBoolean(n)?new A(e,t):null};var D=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,1e3/60)},z=function(){function e(){f(this,e),this.backgroundElement=document.createElement("div"),s.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),M.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),s.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var t=this;M.bind(this.backgroundElement,"click",function(){t.hide()})}return g(e,[{key:"show",value:function(){var e=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),s.defer(function(){e.backgroundElement.style.opacity=1,e.domElement.style.opacity=1,e.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var e=this,t=function t(){e.domElement.style.display="none",e.backgroundElement.style.display="none",M.unbind(e.domElement,"webkitTransitionEnd",t),M.unbind(e.domElement,"transitionend",t),M.unbind(e.domElement,"oTransitionEnd",t)};M.bind(this.domElement,"webkitTransitionEnd",t),M.bind(this.domElement,"transitionend",t),M.bind(this.domElement,"oTransitionEnd",t),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-M.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-M.getHeight(this.domElement)/2+"px"}}]),e}();F(function(e){if(e&&"undefined"!=typeof window){var t=document.createElement("style");return t.setAttribute("type","text/css"),t.innerHTML=e,document.head.appendChild(t),e}}(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n"));var G="Default",U=function(){try{return!!window.localStorage}catch(e){return!1}}(),W=void 0,q=!0,Q=void 0,X=!1,J=[],Y=function e(t){var n=this,o=t||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),M.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],o=s.defaults(o,{closeOnTop:!1,autoPlace:!0,width:e.DEFAULT_WIDTH}),o=s.defaults(o,{resizable:o.autoPlace,hideable:o.autoPlace}),s.isUndefined(o.load)?o.load={preset:G}:o.preset&&(o.load.preset=o.preset),s.isUndefined(o.parent)&&o.hideable&&J.push(this),o.resizable=s.isUndefined(o.parent)&&o.resizable,o.autoPlace&&s.isUndefined(o.scrollable)&&(o.scrollable=!0);var i,r=U&&"true"===localStorage.getItem(ne(this,"isLocal")),a=void 0;if(Object.defineProperties(this,{parent:{get:function(){return o.parent}},scrollable:{get:function(){return o.scrollable}},autoPlace:{get:function(){return o.autoPlace}},closeOnTop:{get:function(){return o.closeOnTop}},preset:{get:function(){return n.parent?n.getRoot().preset:o.load.preset},set:function(e){n.parent?n.getRoot().preset=e:o.load.preset=e,function(e){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].value===e.preset&&(e.__preset_select.selectedIndex=t)}(this),n.revert()}},width:{get:function(){return o.width},set:function(e){o.width=e,se(n,e)}},name:{get:function(){return o.name},set:function(e){o.name=e,titleRowName&&(titleRowName.innerHTML=o.name)}},closed:{get:function(){return o.closed},set:function(t){o.closed=t,o.closed?M.addClass(n.__ul,e.CLASS_CLOSED):M.removeClass(n.__ul,e.CLASS_CLOSED),this.onResize(),n.__closeButton&&(n.__closeButton.innerHTML=t?e.TEXT_OPEN:e.TEXT_CLOSED)}},load:{get:function(){return o.load}},useLocalStorage:{get:function(){return r},set:function(e){U&&(r=e,e?M.bind(window,"unload",a):M.unbind(window,"unload",a),localStorage.setItem(ne(n,"isLocal"),e))}}}),s.isUndefined(o.parent)){if(o.closed=!1,M.addClass(this.domElement,e.CLASS_MAIN),M.makeSelectable(this.domElement,!1),U&&r){n.useLocalStorage=!0;var l=localStorage.getItem(ne(this,"gui"));l&&(o.load=JSON.parse(l))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=e.TEXT_CLOSED,M.addClass(this.__closeButton,e.CLASS_CLOSE_BUTTON),o.closeOnTop?(M.addClass(this.__closeButton,e.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(M.addClass(this.__closeButton,e.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),M.bind(this.__closeButton,"click",function(){n.closed=!n.closed})}else{void 0===o.closed&&(o.closed=!0);var u=document.createTextNode(o.name);M.addClass(u,"controller-name");var c=K(n,u);M.addClass(this.__ul,e.CLASS_CLOSED),M.addClass(c,"title"),M.bind(c,"click",function(e){return e.preventDefault(),n.closed=!n.closed,!1}),o.closed||(this.closed=!1)}o.autoPlace&&(s.isUndefined(o.parent)&&(q&&(Q=document.createElement("div"),M.addClass(Q,"dg"),M.addClass(Q,e.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(Q),q=!1),Q.appendChild(this.domElement),M.addClass(this.domElement,e.CLASS_AUTO_PLACE)),this.parent||se(n,o.width)),this.__resizeHandler=function(){n.onResizeDebounced()},M.bind(window,"resize",this.__resizeHandler),M.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),M.bind(this.__ul,"transitionend",this.__resizeHandler),M.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),o.resizable&&re(this),a=function(){U&&"true"===localStorage.getItem(ne(n,"isLocal"))&&localStorage.setItem(ne(n,"gui"),JSON.stringify(n.getSaveObject()))},this.saveToLocalStorageIfPossible=a,o.parent||((i=n.getRoot()).width+=1,s.defer(function(){i.width-=1}))};function K(e,t,n){var o=document.createElement("li");return t&&o.appendChild(t),n?e.__ul.insertBefore(o,n):e.__ul.appendChild(o),e.onResize(),o}function Z(e){M.unbind(window,"resize",e.__resizeHandler),e.saveToLocalStorageIfPossible&&M.unbind(window,"unload",e.saveToLocalStorageIfPossible)}function $(e,t){var n=e.__preset_select[e.__preset_select.selectedIndex];n.innerHTML=t?n.value+"*":n.value}function ee(e,t){var n=e.getRoot(),o=n.__rememberedObjects.indexOf(t.object);if(-1!==o){var i=n.__rememberedObjectIndecesToControllers[o];if(void 0===i&&(i={},n.__rememberedObjectIndecesToControllers[o]=i),i[t.property]=t,n.load&&n.load.remembered){var r=n.load.remembered,s=void 0;if(r[e.preset])s=r[e.preset];else{if(!r[G])return;s=r[G]}if(s[o]&&void 0!==s[o][t.property]){var a=s[o][t.property];t.initialValue=a,t.setValue(a)}}}}function te(e,t,n,o){if(void 0===t[n])throw new Error('Object "'+t+'" has no property "'+n+'"');var i=void 0;if(o.color)i=new B(t,n);else{var r=[t,n].concat(o.factoryArgs);i=H.apply(e,r)}o.before instanceof k&&(o.before=o.before.__li),ee(e,i),M.addClass(i.domElement,"c");var a=document.createElement("span");M.addClass(a,"property-name"),a.innerHTML=i.property;var l=document.createElement("div");l.appendChild(a),l.appendChild(i.domElement);var u=K(e,l,o.before);return M.addClass(u,Y.CLASS_CONTROLLER_ROW),i instanceof B?M.addClass(u,"color"):M.addClass(u,p(i.getValue())),function(e,t,n){if(n.__li=t,n.__gui=e,s.extend(n,{options:function(t){if(arguments.length>1){var o=n.__li.nextElementSibling;return n.remove(),te(e,n.object,n.property,{before:o,factoryArgs:[s.toArray(arguments)]})}if(s.isArray(t)||s.isObject(t)){var i=n.__li.nextElementSibling;return n.remove(),te(e,n.object,n.property,{before:i,factoryArgs:[t]})}},name:function(e){return n.__li.firstElementChild.firstElementChild.innerHTML=e,n},listen:function(){return n.__gui.listen(n),n},remove:function(){return n.__gui.remove(n),n}}),n instanceof N){var o=new T(n.object,n.property,{min:n.__min,max:n.__max,step:n.__step});s.each(["updateDisplay","onChange","onFinishChange","step"],function(e){var t=n[e],i=o[e];n[e]=o[e]=function(){var e=Array.prototype.slice.call(arguments);return i.apply(o,e),t.apply(n,e)}}),M.addClass(t,"has-slider"),n.domElement.insertBefore(o.domElement,n.domElement.firstElementChild)}else if(n instanceof T){var i=function(t){if(s.isNumber(n.__min)&&s.isNumber(n.__max)){var o=n.__li.firstElementChild.firstElementChild.innerHTML,i=n.__gui.__listening.indexOf(n)>-1;n.remove();var r=te(e,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[n.__min,n.__max,n.__step]});return r.name(o),i&&r.listen(),r}return t};n.min=s.compose(i,n.min),n.max=s.compose(i,n.max)}else n instanceof A?(M.bind(t,"click",function(){M.fakeEvent(n.__checkbox,"click")}),M.bind(n.__checkbox,"click",function(e){e.stopPropagation()})):n instanceof V?(M.bind(t,"click",function(){M.fakeEvent(n.__button,"click")}),M.bind(t,"mouseover",function(){M.addClass(n.__button,"hover")}),M.bind(t,"mouseout",function(){M.removeClass(n.__button,"hover")})):n instanceof B&&(M.addClass(t,"color"),n.updateDisplay=s.compose(function(e){return t.style.borderLeftColor=n.__color.toString(),e},n.updateDisplay),n.updateDisplay());n.setValue=s.compose(function(t){return e.getRoot().__preset_select&&n.isModified()&&$(e.getRoot(),!0),t},n.setValue)}(e,u,i),e.__controllers.push(i),i}function ne(e,t){return document.location.href+"."+t}function oe(e,t,n){var o=document.createElement("option");o.innerHTML=t,o.value=t,e.__preset_select.appendChild(o),n&&(e.__preset_select.selectedIndex=e.__preset_select.length-1)}function ie(e,t){t.style.display=e.useLocalStorage?"block":"none"}function re(e){var t=void 0;function n(n){return n.preventDefault(),e.width+=t-n.clientX,e.onResize(),t=n.clientX,!1}function o(){M.removeClass(e.__closeButton,Y.CLASS_DRAG),M.unbind(window,"mousemove",n),M.unbind(window,"mouseup",o)}function i(i){return i.preventDefault(),t=i.clientX,M.addClass(e.__closeButton,Y.CLASS_DRAG),M.bind(window,"mousemove",n),M.bind(window,"mouseup",o),!1}e.__resize_handle=document.createElement("div"),s.extend(e.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),M.bind(e.__resize_handle,"mousedown",i),M.bind(e.__closeButton,"mousedown",i),e.domElement.insertBefore(e.__resize_handle,e.domElement.firstElementChild)}function se(e,t){e.domElement.style.width=t+"px",e.__save_row&&e.autoPlace&&(e.__save_row.style.width=t+"px"),e.__closeButton&&(e.__closeButton.style.width=t+"px")}function ae(e,t){var n={};return s.each(e.__rememberedObjects,function(o,i){var r={},a=e.__rememberedObjectIndecesToControllers[i];s.each(a,function(e,n){r[n]=t?e.initialValue:e.getValue()}),n[i]=r}),n}Y.toggleHide=function(){X=!X,s.each(J,function(e){e.domElement.style.display=X?"none":""})},Y.CLASS_AUTO_PLACE="a",Y.CLASS_AUTO_PLACE_CONTAINER="ac",Y.CLASS_MAIN="main",Y.CLASS_CONTROLLER_ROW="cr",Y.CLASS_TOO_TALL="taller-than-window",Y.CLASS_CLOSED="closed",Y.CLASS_CLOSE_BUTTON="close-button",Y.CLASS_CLOSE_TOP="close-top",Y.CLASS_CLOSE_BOTTOM="close-bottom",Y.CLASS_DRAG="drag",Y.DEFAULT_WIDTH=245,Y.TEXT_CLOSED="Close Controls",Y.TEXT_OPEN="Open Controls",Y._keydownHandler=function(e){"text"===document.activeElement.type||72!==e.which&&72!==e.keyCode||Y.toggleHide()},M.bind(window,"keydown",Y._keydownHandler,!1),s.extend(Y.prototype,{add:function(e,t){return te(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return te(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;s.defer(function(){t.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&Q.removeChild(this.domElement);var e=this;s.each(this.__folders,function(t){e.removeFolder(t)}),M.unbind(window,"keydown",Y._keydownHandler,!1),Z(this)},addFolder:function(e){if(void 0!==this.__folders[e])throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var n=new Y(t);this.__folders[e]=n;var o=K(this,n.domElement);return M.addClass(o,"folder"),n},removeFolder:function(e){this.__ul.removeChild(e.domElement.parentElement),delete this.__folders[e.name],this.load&&this.load.folders&&this.load.folders[e.name]&&delete this.load.folders[e.name],Z(e);var t=this;s.each(e.__folders,function(t){e.removeFolder(t)}),s.defer(function(){t.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=M.getOffset(e.__ul).top,n=0;s.each(e.__ul.childNodes,function(t){e.autoPlace&&t===e.__save_row||(n+=M.getHeight(t))}),window.innerHeight-t-20<n?(M.addClass(e.domElement,Y.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-20+"px"):(M.removeClass(e.domElement,Y.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&s.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"}),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:s.debounce(function(){this.onResize()},50),remember:function(){if(s.isUndefined(W)&&((W=new z).domElement.innerHTML='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>'),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;s.each(Array.prototype.slice.call(arguments),function(t){0===e.__rememberedObjects.length&&function(e){var t=e.__save_row=document.createElement("li");M.addClass(e.domElement,"has-save"),e.__ul.insertBefore(t,e.__ul.firstChild),M.addClass(t,"save-row");var n=document.createElement("span");n.innerHTML="&nbsp;",M.addClass(n,"button gears");var o=document.createElement("span");o.innerHTML="Save",M.addClass(o,"button"),M.addClass(o,"save");var i=document.createElement("span");i.innerHTML="New",M.addClass(i,"button"),M.addClass(i,"save-as");var r=document.createElement("span");r.innerHTML="Revert",M.addClass(r,"button"),M.addClass(r,"revert");var a=e.__preset_select=document.createElement("select");e.load&&e.load.remembered?s.each(e.load.remembered,function(t,n){oe(e,n,n===e.preset)}):oe(e,G,!1);if(M.bind(a,"change",function(){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].innerHTML=e.__preset_select[t].value;e.preset=this.value}),t.appendChild(a),t.appendChild(n),t.appendChild(o),t.appendChild(i),t.appendChild(r),U){var l=document.getElementById("dg-local-explain"),u=document.getElementById("dg-local-storage"),c=document.getElementById("dg-save-locally");c.style.display="block","true"===localStorage.getItem(ne(e,"isLocal"))&&u.setAttribute("checked","checked"),ie(e,l),M.bind(u,"change",function(){e.useLocalStorage=!e.useLocalStorage,ie(e,l)})}var d=document.getElementById("dg-new-constructor");M.bind(d,"keydown",function(e){!e.metaKey||67!==e.which&&67!==e.keyCode||W.hide()}),M.bind(n,"click",function(){d.innerHTML=JSON.stringify(e.getSaveObject(),void 0,2),W.show(),d.focus(),d.select()}),M.bind(o,"click",function(){e.save()}),M.bind(i,"click",function(){var t=prompt("Enter a new preset name.");t&&e.saveAs(t)}),M.bind(r,"click",function(){e.revert()})}(e),-1===e.__rememberedObjects.indexOf(t)&&e.__rememberedObjects.push(t)}),this.autoPlace&&se(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=ae(this)),e.folders={},s.each(this.__folders,function(t,n){e.folders[n]=t.getSaveObject()}),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=ae(this),$(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[G]=ae(this,!0)),this.load.remembered[e]=ae(this),this.preset=e,oe(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){s.each(this.__controllers,function(t){this.getRoot().load.remembered?ee(e||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())},this),s.each(this.__folders,function(e){e.revert(e)}),e||$(this.getRoot(),!1)},listen:function(e){var t=0===this.__listening.length;this.__listening.push(e),t&&function e(t){0!==t.length&&D.call(window,function(){e(t)});s.each(t,function(e){e.updateDisplay()})}(this.__listening)},updateDisplay:function(){s.each(this.__controllers,function(e){e.updateDisplay()}),s.each(this.__folders,function(e){e.updateDisplay()})}});let le=new Y;var ue=n(6),ce=n(5),de=n.n(ce);let he=0,pe={};function fe(e,t,n){pe[++he]=n,window[t]=function(){let e,t=document.currentScript.attributes;for(var n=t.length-1;n>=0;n--)if("data-scriptid"===t[n].name){e=t[n].value;break}pe[e].apply(null,arguments),delete pe[e]},de()(e,{removeScript:!0,attrs:{"data-scriptid":`${he}`}}).then(t=>{console.log(`Loaded ${e}`)})}let ge={};var me=ge;void 0===ge&&(ge={}),ge.Validator={isValid:function(e){return null!==e&&void 0!==e},verifyInput:function(e,t){return null===e||void 0===e?t:e}},ge.Callbacks=function(){var e=ge.Validator;function t(){this.onProgress=null,this.onMeshAlter=null,this.onLoad=null,this.onLoadMaterials=null}return t.prototype.setCallbackOnProgress=function(t){this.onProgress=e.verifyInput(t,this.onProgress)},t.prototype.setCallbackOnMeshAlter=function(t){this.onMeshAlter=e.verifyInput(t,this.onMeshAlter)},t.prototype.setCallbackOnLoad=function(t){this.onLoad=e.verifyInput(t,this.onLoad)},t.prototype.setCallbackOnLoadMaterials=function(t){this.onLoadMaterials=e.verifyInput(t,this.onLoadMaterials)},t}(),ge.LoadedMeshUserOverride=function(){function e(e,t){this.disregardMesh=!0===e,this.alteredMesh=!0===t,this.meshes=[]}return e.prototype.addMesh=function(e){this.meshes.push(e),this.alteredMesh=!0},e.prototype.isDisregardMesh=function(){return this.disregardMesh},e.prototype.providesAlteredMeshes=function(){return this.alteredMesh},e}(),ge.ResourceDescriptor=function(){var e=ge.Validator;function t(t,n){var o=t.split("/");o.length<2?(this.path=null,this.name=t,this.url=t):(this.path=e.verifyInput(o.slice(0,o.length-1).join("/")+"/",null),this.name=o[o.length-1],this.url=t),this.name=e.verifyInput(this.name,"Unnamed_Resource"),this.extension=e.verifyInput(n,"default"),this.extension=this.extension.trim(),this.content=null}return t.prototype.setContent=function(t){this.content=e.verifyInput(t,null)},t}(),ge.PrepData=function(){var e=ge.Validator;function t(t){this.logging={enabled:!0,debug:!1},this.modelName=e.verifyInput(t,""),this.resources=[],this.callbacks=new ge.Callbacks}return t.prototype.setLogging=function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t},t.prototype.getCallbacks=function(){return this.callbacks},t.prototype.addResource=function(e){this.resources.push(e)},t.prototype.clone=function(){var e,t,n=new ge.PrepData(this.modelName);for(e in n.logging.enabled=this.logging.enabled,n.logging.debug=this.logging.debug,n.resources=this.resources,n.callbacks=this.callbacks,this)t=this[e],n.hasOwnProperty(e)||"function"==typeof this[e]||(n[e]=t);return n},t.prototype.checkResourceDescriptorFiles=function(t,n){var o,i,r,s,a={};for(var l in t)if(o=t[l],s=!1,e.isValid(o.name))if(e.isValid(o.content)){for(r=0;r<n.length&&!s;r++)if(i=n[r],o.extension.toLowerCase()===i.ext.toLowerCase())if(i.ignore)s=!0;else if("ArrayBuffer"===i.type){if(!(o.content instanceof ArrayBuffer||o.content instanceof Uint8Array))throw"Provided content is not of type ArrayBuffer! Aborting...";a[i.ext]=o,s=!0}else if("String"===i.type){if(!("string"==typeof o.content||o.content instanceof String))throw"Provided  content is not of type String! Aborting...";a[i.ext]=o,s=!0}if(!s)throw'Unidentified resource "'+o.name+'": '+o.url}else{if(!("string"==typeof o.name||o.name instanceof String))throw"Provided file is not properly defined! Aborting...";for(r=0;r<n.length&&!s;r++)i=n[r],o.extension.toLowerCase()===i.ext.toLowerCase()&&(i.ignore||(a[i.ext]=o),s=!0);if(!s)throw'Unidentified resource "'+o.name+'": '+o.url}return a},t}(),ge.MeshBuilder=function(){var e="1.2.1",t=ge.Validator;function n(){console.info("Using LoaderSupport.MeshBuilder version: "+e),this.logging={enabled:!0,debug:!1},this.callbacks=new ge.Callbacks,this.materials=[]}return n.prototype.setLogging=function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t},n.prototype.init=function(){var e=new THREE.MeshStandardMaterial({color:14479871});e.name="defaultMaterial";var t=new THREE.MeshStandardMaterial({color:14479871});t.name="defaultVertexColorMaterial",t.vertexColors=THREE.VertexColors;var n=new THREE.LineBasicMaterial;n.name="defaultLineMaterial";var o=new THREE.PointsMaterial({size:1});o.name="defaultPointMaterial";var i={};i[e.name]=e,i[t.name]=t,i[n.name]=n,i[o.name]=o,this.updateMaterials({cmd:"materialData",materials:{materialCloneInstructions:null,serializedMaterials:null,runtimeMaterials:i}})},n.prototype.setMaterials=function(e){var n={cmd:"materialData",materials:{materialCloneInstructions:null,serializedMaterials:null,runtimeMaterials:t.isValid(this.callbacks.onLoadMaterials)?this.callbacks.onLoadMaterials(e):e}};this.updateMaterials(n)},n.prototype._setCallbacks=function(e){t.isValid(e.onProgress)&&this.callbacks.setCallbackOnProgress(e.onProgress),t.isValid(e.onMeshAlter)&&this.callbacks.setCallbackOnMeshAlter(e.onMeshAlter),t.isValid(e.onLoad)&&this.callbacks.setCallbackOnLoad(e.onLoad),t.isValid(e.onLoadMaterials)&&this.callbacks.setCallbackOnLoadMaterials(e.onLoadMaterials)},n.prototype.processPayload=function(e){return"meshData"===e.cmd?this.buildMeshes(e):"materialData"===e.cmd?(this.updateMaterials(e),null):void 0},n.prototype.buildMeshes=function(e){var n,o,i,r=e.params.meshName,s=new THREE.BufferGeometry;s.addAttribute("position",new THREE.BufferAttribute(new Float32Array(e.buffers.vertices),3)),t.isValid(e.buffers.indices)&&s.setIndex(new THREE.BufferAttribute(new Uint32Array(e.buffers.indices),1)),t.isValid(e.buffers.colors)&&s.addAttribute("color",new THREE.BufferAttribute(new Float32Array(e.buffers.colors),3)),t.isValid(e.buffers.normals)?s.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(e.buffers.normals),3)):s.computeVertexNormals(),t.isValid(e.buffers.uvs)&&s.addAttribute("uv",new THREE.BufferAttribute(new Float32Array(e.buffers.uvs),2));var a=e.materials.materialNames,l=e.materials.multiMaterial,u=[];for(i in a)o=a[i],n=this.materials[o],l&&u.push(n);if(l){n=u;var c,d=e.materials.materialGroups;for(i in d)c=d[i],s.addGroup(c.start,c.count,c.index)}var h,p,f,g=[],m=this.callbacks.onMeshAlter,b=!0,_=t.verifyInput(e.geometryType,0);if(t.isValid(m)&&(p=m({detail:{meshName:r,bufferGeometry:s,material:n,geometryType:_}}),t.isValid(p)))if(p.isDisregardMesh())b=!1;else if(p.providesAlteredMeshes()){for(var v in p.meshes)g.push(p.meshes[v]);b=!1}if(b&&(e.computeBoundingSphere&&s.computeBoundingSphere(),(h=0===_?new THREE.Mesh(s,n):1===_?new THREE.LineSegments(s,n):new THREE.Points(s,n)).name=r,g.push(h)),t.isValid(g)&&g.length>0){var y=[];for(var v in g)h=g[v],y[v]=h.name;f="Adding mesh(es) ("+y.length+": "+y+") from input mesh: "+r,f+=" ("+(100*e.progress.numericalValue).toFixed(2)+"%)"}else f="Not adding mesh: "+r,f+=" ("+(100*e.progress.numericalValue).toFixed(2)+"%)";var w=this.callbacks.onProgress;t.isValid(w)&&w(new CustomEvent("MeshBuilderEvent",{detail:{type:"progress",modelName:e.params.meshName,text:f,numericalValue:e.progress.numericalValue}}));return g},n.prototype.updateMaterials=function(e){var n,o,i=e.materials.materialCloneInstructions;if(t.isValid(i)){var r=i.materialNameOrg,s=this.materials[r];if(t.isValid(r)){n=s.clone(),o=i.materialName,n.name=o;var a=i.materialProperties;for(var l in a)n.hasOwnProperty(l)&&a.hasOwnProperty(l)&&(n[l]=a[l]);this.materials[o]=n}else console.warn('Requested material "'+r+'" is not available!')}var u=e.materials.serializedMaterials;if(t.isValid(u)&&Object.keys(u).length>0){var c,d=new THREE.MaterialLoader;for(o in u)c=u[o],t.isValid(c)&&(n=d.parse(c),this.logging.enabled&&console.info('De-serialized material with name "'+o+'" will be added.'),this.materials[o]=n)}if(u=e.materials.runtimeMaterials,t.isValid(u)&&Object.keys(u).length>0)for(o in u)n=u[o],this.logging.enabled&&console.info('Material with name "'+o+'" will be added.'),this.materials[o]=n},n.prototype.getMaterialsJSON=function(){var e,t={};for(var n in this.materials)e=this.materials[n],t[n]=e.toJSON();return t},n.prototype.getMaterials=function(){return this.materials},n}(),ge.WorkerRunnerRefImpl=function(){function e(){var e=this;self.addEventListener("message",function(t){e.processMessage(t.data)},!1)}return e.prototype.applyProperties=function(e,t){var n,o,i;for(n in t)o="set"+n.substring(0,1).toLocaleUpperCase()+n.substring(1),i=t[n],"function"==typeof e[o]?e[o](i):e.hasOwnProperty(n)&&(e[n]=i)},e.prototype.processMessage=function(e){if("run"===e.cmd){var t={callbackMeshBuilder:function(e){self.postMessage(e)},callbackProgress:function(t){e.logging.enabled&&e.logging.debug&&console.debug("WorkerRunner: progress: "+t)}},n=new Parser;"function"==typeof n.setLogging&&n.setLogging(e.logging.enabled,e.logging.debug),this.applyProperties(n,e.params),this.applyProperties(n,e.materials),this.applyProperties(n,t),n.workerScope=self,n.parse(e.data.input,e.data.options),e.logging.enabled&&console.log("WorkerRunner: Run complete!"),t.callbackMeshBuilder({cmd:"complete",msg:"WorkerRunner completed run."})}else console.error("WorkerRunner: Received unknown command: "+e.cmd)},e}(),ge.WorkerSupport=function(){var e="2.2.0",t=ge.Validator,n=function(){function e(){this._reset()}return e.prototype._reset=function(){this.logging={enabled:!0,debug:!1},this.worker=null,this.runnerImplName=null,this.callbacks={meshBuilder:null,onLoad:null},this.terminateRequested=!1,this.queuedMessage=null,this.started=!1,this.forceCopy=!1},e.prototype.setLogging=function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t},e.prototype.setForceCopy=function(e){this.forceCopy=!0===e},e.prototype.initWorker=function(e,t){this.runnerImplName=t;var n=new Blob([e],{type:"application/javascript"});this.worker=new Worker(window.URL.createObjectURL(n)),this.worker.onmessage=this._receiveWorkerMessage,this.worker.runtimeRef=this,this._postMessage()},e.prototype._receiveWorkerMessage=function(e){var t=e.data;switch(t.cmd){case"meshData":case"materialData":case"imageData":this.runtimeRef.callbacks.meshBuilder(t);break;case"complete":this.runtimeRef.queuedMessage=null,this.started=!1,this.runtimeRef.callbacks.onLoad(t.msg),this.runtimeRef.terminateRequested&&(this.runtimeRef.logging.enabled&&console.info("WorkerSupport ["+this.runtimeRef.runnerImplName+"]: Run is complete. Terminating application on request!"),this.runtimeRef._terminate());break;case"error":console.error("WorkerSupport ["+this.runtimeRef.runnerImplName+"]: Reported error: "+t.msg),this.runtimeRef.queuedMessage=null,this.started=!1,this.runtimeRef.callbacks.onLoad(t.msg),this.runtimeRef.terminateRequested&&(this.runtimeRef.logging.enabled&&console.info("WorkerSupport ["+this.runtimeRef.runnerImplName+"]: Run reported error. Terminating application on request!"),this.runtimeRef._terminate());break;default:console.error("WorkerSupport ["+this.runtimeRef.runnerImplName+"]: Received unknown command: "+t.cmd)}},e.prototype.setCallbacks=function(e,n){this.callbacks.meshBuilder=t.verifyInput(e,this.callbacks.meshBuilder),this.callbacks.onLoad=t.verifyInput(n,this.callbacks.onLoad)},e.prototype.run=function(e){if(t.isValid(this.queuedMessage))console.warn("Already processing message. Rejecting new run instruction");else{if(this.queuedMessage=e,this.started=!0,!t.isValid(this.callbacks.meshBuilder))throw'Unable to run as no "MeshBuilder" callback is set.';if(!t.isValid(this.callbacks.onLoad))throw'Unable to run as no "onLoad" callback is set.';"run"!==e.cmd&&(e.cmd="run"),t.isValid(e.logging)?(e.logging.enabled=!0===e.logging.enabled,e.logging.debug=!0===e.logging.debug):e.logging={enabled:!0,debug:!1},this._postMessage()}},e.prototype._postMessage=function(){var e;t.isValid(this.queuedMessage)&&t.isValid(this.worker)&&(this.queuedMessage.data.input instanceof ArrayBuffer?(e=this.forceCopy?this.queuedMessage.data.input.slice(0):this.queuedMessage.data.input,this.worker.postMessage(this.queuedMessage,[e])):this.worker.postMessage(this.queuedMessage))},e.prototype.setTerminateRequested=function(e){this.terminateRequested=!0===e,this.terminateRequested&&t.isValid(this.worker)&&!t.isValid(this.queuedMessage)&&this.started&&(this.logging.enabled&&console.info("Worker is terminated immediately as it is not running!"),this._terminate())},e.prototype._terminate=function(){this.worker.terminate(),this._reset()},e}();function o(){if(console.info("Using LoaderSupport.WorkerSupport version: "+e),this.logging={enabled:!0,debug:!1},void 0===window.Worker)throw"This browser does not support web workers!";if(void 0===window.Blob)throw"This browser does not support Blob!";if("function"!=typeof window.URL.createObjectURL)throw"This browser does not support Object creation from URL!";this.loaderWorker=new n}o.prototype.setLogging=function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t,this.loaderWorker.setLogging(this.logging.enabled,this.logging.debug)},o.prototype.setForceWorkerDataCopy=function(e){this.loaderWorker.setForceCopy(e)},o.prototype.validate=function(e,n,o,s,a){if(!t.isValid(this.loaderWorker.worker)){this.logging.enabled&&(console.info("WorkerSupport: Building worker code..."),console.time("buildWebWorkerCode")),t.isValid(a)?this.logging.enabled&&console.info('WorkerSupport: Using "'+a.name+'" as Runner class for worker.'):(a=ge.WorkerRunnerRefImpl,this.logging.enabled&&console.info('WorkerSupport: Using DEFAULT "LoaderSupport.WorkerRunnerRefImpl" as Runner class for worker.'));var l=e(i,r);l+="var Parser = "+n+";\n\n",l+=r(a.name,a),l+="new "+a.name+"();\n\n";var u=this;if(t.isValid(o)&&o.length>0){var c="",d=function(e,t){if(0===t.length)u.loaderWorker.initWorker(c+l,a.name),u.logging.enabled&&console.timeEnd("buildWebWorkerCode");else{var n=new THREE.FileLoader;n.setPath(e),n.setResponseType("text"),n.load(t[0],function(n){c+=n,d(e,t)}),t.shift()}};d(s,o)}else this.loaderWorker.initWorker(l,a.name),this.logging.enabled&&console.timeEnd("buildWebWorkerCode")}},o.prototype.setCallbacks=function(e,t){this.loaderWorker.setCallbacks(e,t)},o.prototype.run=function(e){this.loaderWorker.run(e)},o.prototype.setTerminateRequested=function(e){this.loaderWorker.setTerminateRequested(e)};var i=function(e,t){var n,o=e+" = {\n";for(var i in t)"string"==typeof(n=t[i])||n instanceof String?o+="\t"+i+': "'+(n=(n=n.replace("\n","\\n")).replace("\r","\\r"))+'",\n':n instanceof Array?o+="\t"+i+": ["+n+"],\n":Number.isInteger(n)?o+="\t"+i+": "+n+",\n":"function"==typeof n&&(o+="\t"+i+": "+n+",\n");return o+="}\n\n"},r=function(e,n,o,i,r){var s,a,l="",u=t.isValid(o)?o:n.name;for(var c in r=t.verifyInput(r,[]),n.prototype)s=n.prototype[c],"constructor"===c?a="\tfunction "+u+s.toString().replace("function","")+";\n\n":"function"==typeof s&&r.indexOf(c)<0&&(l+="\t"+u+".prototype."+c+" = "+s.toString()+";\n\n");l+="\treturn "+u+";\n",l+="})();\n\n";var d="";return t.isValid(i)&&(d+="\n",d+=u+".prototype = Object.create( "+i+".prototype );\n",d+=u+".constructor = "+u+";\n",d+="\n"),t.isValid(a)?l=e+" = (function () {\n\n"+d+a+l:(a=e+" = (function () {\n\n",l=(a+=d+"\t"+n.prototype.constructor.toString()+"\n\n")+l),l};return o}(),ge.WorkerDirector=function(){var e="2.2.1",t=ge.Validator,n=16,o=8192;function i(i){if(console.info("Using LoaderSupport.WorkerDirector version: "+e),this.logging={enabled:!0,debug:!1},this.maxQueueSize=o,this.maxWebWorkers=n,this.crossOrigin=null,!t.isValid(i))throw"Provided invalid classDef: "+i;this.workerDescription={classDef:i,globalCallbacks:{},workerSupports:{},forceWorkerDataCopy:!0},this.objectsCompleted=0,this.instructionQueue=[],this.instructionQueuePointer=0,this.callbackOnFinishedProcessing=null}return i.prototype.setLogging=function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t},i.prototype.getMaxQueueSize=function(){return this.maxQueueSize},i.prototype.getMaxWebWorkers=function(){return this.maxWebWorkers},i.prototype.setCrossOrigin=function(e){this.crossOrigin=e},i.prototype.setForceWorkerDataCopy=function(e){this.workerDescription.forceWorkerDataCopy=!0===e},i.prototype.prepareWorkers=function(e,i,r){t.isValid(e)&&(this.workerDescription.globalCallbacks=e),this.maxQueueSize=Math.min(i,o),this.maxWebWorkers=Math.min(r,n),this.maxWebWorkers=Math.min(this.maxWebWorkers,this.maxQueueSize),this.objectsCompleted=0,this.instructionQueue=[],this.instructionQueuePointer=0;for(var s=0;s<this.maxWebWorkers;s++){var a=new ge.WorkerSupport;a.setLogging(this.logging.enabled,this.logging.debug),a.setForceWorkerDataCopy(this.workerDescription.forceWorkerDataCopy),this.workerDescription.workerSupports[s]={instanceNo:s,inUse:!1,terminateRequested:!1,workerSupport:a,loader:null}}},i.prototype.enqueueForRun=function(e){this.instructionQueue.length<this.maxQueueSize&&this.instructionQueue.push(e)},i.prototype.isRunning=function(){var e=Object.keys(this.workerDescription.workerSupports);return this.instructionQueue.length>0&&this.instructionQueuePointer<this.instructionQueue.length||e.length>0},i.prototype.processQueue=function(){var e,t;for(var n in this.workerDescription.workerSupports)(t=this.workerDescription.workerSupports[n]).inUse||(this.instructionQueuePointer<this.instructionQueue.length?(e=this.instructionQueue[this.instructionQueuePointer],this._kickWorkerRun(e,t),this.instructionQueuePointer++):this._deregister(t));this.isRunning()||null===this.callbackOnFinishedProcessing||(this.callbackOnFinishedProcessing(),this.callbackOnFinishedProcessing=null)},i.prototype._kickWorkerRun=function(e,n){n.inUse=!0,n.workerSupport.setTerminateRequested(n.terminateRequested),this.logging.enabled&&console.info("\nAssigning next item from queue to worker (queue length: "+this.instructionQueue.length+")\n\n");var o=this,i=e.getCallbacks(),r=this.workerDescription.globalCallbacks;n.loader=this._buildLoader(n.instanceNo);var s=new ge.Callbacks;s.setCallbackOnLoad(function(e){t.isValid(r.onLoad)&&r.onLoad(e),t.isValid(i.onLoad)&&i.onLoad(e),o.objectsCompleted++,n.inUse=!1,o.processQueue()}),s.setCallbackOnProgress(function(e){t.isValid(r.onProgress)&&r.onProgress(e),t.isValid(i.onProgress)&&i.onProgress(e)}),s.setCallbackOnMeshAlter(function(e,n){return t.isValid(r.onMeshAlter)&&(n=r.onMeshAlter(e,n)),t.isValid(i.onMeshAlter)&&(n=r.onMeshAlter(e,n)),n}),s.setCallbackOnLoadMaterials(function(e){return t.isValid(r.onLoadMaterials)&&(e=r.onLoadMaterials(e)),t.isValid(i.onLoadMaterials)&&(e=i.onLoadMaterials(e)),e}),e.callbacks=s,n.loader.run(e,n.workerSupport)},i.prototype._buildLoader=function(e){var n=this.workerDescription.classDef,o=Object.create(n.prototype);if(n.call(o,THREE.DefaultLoadingManager),!o.hasOwnProperty("instanceNo"))throw n.name+' has no property "instanceNo".';if(o.instanceNo=e,!o.hasOwnProperty("workerSupport"))throw n.name+' has no property "workerSupport".';if("function"!=typeof o.run)throw n.name+' has no function "run".';return o.hasOwnProperty("callbacks")&&t.isValid(o.callbacks)||(console.warn(n.name+' has an invalid property "callbacks". Will change to "LoaderSupport.Callbacks"'),o.callbacks=new ge.Callbacks),o},i.prototype._deregister=function(e){if(t.isValid(e)){e.workerSupport.setTerminateRequested(!0),this.logging.enabled&&console.info("Requested termination of worker #"+e.instanceNo+".");var n=e.loader.callbacks;t.isValid(n.onProgress)&&n.onProgress({detail:{text:""}}),delete this.workerDescription.workerSupports[e.instanceNo]}},i.prototype.tearDown=function(e){for(var n in this.logging.enabled&&console.info("WorkerDirector received the deregister call. Terminating all workers!"),this.instructionQueuePointer=this.instructionQueue.length,this.callbackOnFinishedProcessing=t.verifyInput(e,null),this.workerDescription.workerSupports)this.workerDescription.workerSupports[n].terminateRequested=!0},i}();let be=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager};var _e=be;be.prototype={constructor:be,load:function(e,t,n,o){var i=this,r=new THREE.FileLoader(this.manager);r.setPath(this.path),r.load(e,function(e){t(i.parse(e))},n,o)},setPath:function(e){return this.path=e,this},setTexturePath:function(e){return this.texturePath=e,this},setBaseUrl:function(e){return console.warn("MTLLoader: .setBaseUrl() is deprecated. Use .setTexturePath( path ) for texture path or .setPath( path ) for general base path instead."),this.setTexturePath(e)},setCrossOrigin:function(e){return this.crossOrigin=e,this},setMaterialOptions:function(e){return this.materialOptions=e,this},parse:function(e){for(var t=e.split("\n"),n={},o=/\s+/,i={},r=0;r<t.length;r++){var s=t[r];if(0!==(s=s.trim()).length&&"#"!==s.charAt(0)){var a=s.indexOf(" "),l=a>=0?s.substring(0,a):s;l=l.toLowerCase();var u=a>=0?s.substring(a+1):"";if(u=u.trim(),"newmtl"===l)n={name:u},i[u]=n;else if(n)if("ka"===l||"kd"===l||"ks"===l){var c=u.split(o,3);n[l]=[parseFloat(c[0]),parseFloat(c[1]),parseFloat(c[2])]}else n[l]=u}}var d=new be.MaterialCreator(this.texturePath||this.path,this.materialOptions);return d.setCrossOrigin(this.crossOrigin),d.setManager(this.manager),d.setMaterials(i),d}},(be.MaterialCreator=function(e,t){this.baseUrl=e||"",this.options=t,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:THREE.FrontSide,this.wrap=this.options&&this.options.wrap?this.options.wrap:THREE.RepeatWrapping}).prototype={constructor:be.MaterialCreator,crossOrigin:"Anonymous",setCrossOrigin:function(e){this.crossOrigin=e},setManager:function(e){this.manager=e},setMaterials:function(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(e){if(!this.options)return e;var t={};for(var n in e){var o=e[n],i={};for(var r in t[n]=i,o){var s=!0,a=o[r],l=r.toLowerCase();switch(l){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(a=[a[0]/255,a[1]/255,a[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===a[0]&&0===a[1]&&0===a[2]&&(s=!1)}s&&(i[l]=a)}}return t},preload:function(){for(var e in this.materialsInfo)this.create(e)},getIndex:function(e){return this.nameLookup[e]},getAsArray:function(){var e=0;for(var t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray},create:function(e){return void 0===this.materials[e]&&this.createMaterial_(e),this.materials[e]},createMaterial_:function(e){var t=this,n=this.materialsInfo[e],o={name:e,side:this.side};function i(e,n){if(!o[e]){var i,r,s=t.getTextureParams(n,o),a=t.loadTexture((i=t.baseUrl,"string"!=typeof(r=s.url)||""===r?"":/^https?:\/\//i.test(r)?r:i+r));a.repeat.copy(s.scale),a.offset.copy(s.offset),a.wrapS=t.wrap,a.wrapT=t.wrap,o[e]=a}}for(var r in n){var s,a=n[r];if(""!==a)switch(r.toLowerCase()){case"kd":o.color=(new THREE.Color).fromArray(a);break;case"ks":o.specular=(new THREE.Color).fromArray(a);break;case"map_kd":i("map",a);break;case"map_ks":i("specularMap",a);break;case"norm":i("normalMap",a);break;case"map_bump":case"bump":i("bumpMap",a);break;case"ns":o.shininess=parseFloat(a);break;case"d":(s=parseFloat(a))<1&&(o.opacity=s,o.transparent=!0);break;case"tr":s=parseFloat(a),this.options&&this.options.invertTrProperty&&(s=1-s),s>0&&(o.opacity=1-s,o.transparent=!0);break;case"alpha":s=parseFloat(a),o.alphaTest=s}}return this.materials[e]=new THREE.MeshPhongMaterial(o),this.materials[e]},getTextureParams:function(e,t){var n,o={scale:new THREE.Vector2(1,1),offset:new THREE.Vector2(0,0)},i=e.split(/\s+/);return(n=i.indexOf("-bm"))>=0&&(t.bumpScale=parseFloat(i[n+1]),i.splice(n,2)),(n=i.indexOf("-s"))>=0&&(o.scale.set(parseFloat(i[n+1]),parseFloat(i[n+2])),i.splice(n,4)),(n=i.indexOf("-o"))>=0&&(o.offset.set(parseFloat(i[n+1]),parseFloat(i[n+2])),i.splice(n,4)),o.url=i.join(" ").trim(),o},loadTexture:function(e,t,n,o,i){var r,s=THREE.Loader.Handlers.get(e),a=void 0!==this.manager?this.manager:THREE.DefaultLoadingManager;return null===s&&(s=new THREE.TextureLoader(a)),s.setCrossOrigin&&s.setCrossOrigin(this.crossOrigin),r=s.load(e,n,o,i),void 0!==t&&(r.mapping=t),r}},void 0===me&&console.error('"LoaderSupport" is not available. "OBJLoader2" requires it. Please include "LoaderSupport.js" in your HTML.');var ve=function(){var e="2.4.1",t=me.Validator;function n(n){console.info("Using OBJLoader2 version: "+e),this.manager=t.verifyInput(n,THREE.DefaultLoadingManager),this.logging={enabled:!0,debug:!1},this.modelName="",this.instanceNo=0,this.path="",this.useIndices=!1,this.disregardNormals=!1,this.materialPerSmoothingGroup=!1,this.useOAsMesh=!1,this.loaderRootNode=new THREE.Group,this.meshBuilder=new me.MeshBuilder,this.callbacks=new me.Callbacks,this.workerSupport=new me.WorkerSupport,this.terminateWorkerOnLoad=!0}n.prototype.setLogging=function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t,this.meshBuilder.setLogging(this.logging.enabled,this.logging.debug)},n.prototype.setModelName=function(e){this.modelName=t.verifyInput(e,this.modelName)},n.prototype.setPath=function(e){this.path=t.verifyInput(e,this.path)},n.prototype.setStreamMeshesTo=function(e){this.loaderRootNode=t.verifyInput(e,this.loaderRootNode)},n.prototype.setMaterials=function(e){this.meshBuilder.setMaterials(e)},n.prototype.setUseIndices=function(e){this.useIndices=!0===e},n.prototype.setDisregardNormals=function(e){this.disregardNormals=!0===e},n.prototype.setMaterialPerSmoothingGroup=function(e){this.materialPerSmoothingGroup=!0===e},n.prototype.setUseOAsMesh=function(e){this.useOAsMesh=!0===e},n.prototype._setCallbacks=function(e){t.isValid(e.onProgress)&&this.callbacks.setCallbackOnProgress(e.onProgress),t.isValid(e.onMeshAlter)&&this.callbacks.setCallbackOnMeshAlter(e.onMeshAlter),t.isValid(e.onLoad)&&this.callbacks.setCallbackOnLoad(e.onLoad),t.isValid(e.onLoadMaterials)&&this.callbacks.setCallbackOnLoadMaterials(e.onLoadMaterials),this.meshBuilder._setCallbacks(this.callbacks)},n.prototype.onProgress=function(e,n,o){var i=t.isValid(n)?n:"",r={detail:{type:e,modelName:this.modelName,instanceNo:this.instanceNo,text:i,numericalValue:o}};t.isValid(this.callbacks.onProgress)&&this.callbacks.onProgress(r),this.logging.enabled&&this.logging.debug&&console.debug(i)},n.prototype._onError=function(e){var t="Error occurred while downloading!";throw e.currentTarget&&null!==e.currentTarget.statusText&&(t+="\nurl: "+e.currentTarget.responseURL+"\nstatus: "+e.currentTarget.statusText),t},n.prototype.load=function(e,t,n,o,i,r){var s=new me.ResourceDescriptor(e,"OBJ");this._loadObj(s,t,n,o,i,r)},n.prototype._loadObj=function(e,n,o,i,r,s){t.isValid(i)||(i=this._onError),t.isValid(e)||i("An invalid ResourceDescriptor was provided. Unable to continue!");var a=this,l=function(t){if(e.content=t,s)a.parseAsync(t,n);else{var o=new me.Callbacks;o.setCallbackOnMeshAlter(r),a._setCallbacks(o),n({detail:{loaderRootNode:a.parse(t),modelName:a.modelName,instanceNo:a.instanceNo}})}};if(!t.isValid(e.url)||t.isValid(e.content))l(t.isValid(e.content)?e.content:null);else{if(!t.isValid(o)){var u=0,c=0;o=function(t){if(t.lengthComputable&&(c=t.loaded/t.total)>u){u=c;var n='Download of "'+e.url+'": '+(100*c).toFixed(2)+"%";a.onProgress("progressLoad",n,c)}}}var d=new THREE.FileLoader(this.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),d.load(e.url,l,o,i)}},n.prototype.run=function(e,n){this._applyPrepData(e);var o=e.checkResourceDescriptorFiles(e.resources,[{ext:"obj",type:"ArrayBuffer",ignore:!1},{ext:"mtl",type:"String",ignore:!1},{ext:"zip",type:"String",ignore:!0}]);t.isValid(n)&&(this.terminateWorkerOnLoad=!1,this.workerSupport=n,this.logging.enabled=this.workerSupport.logging.enabled,this.logging.debug=this.workerSupport.logging.debug);var i=this;this._loadMtl(o.mtl,function(t){null!==t&&i.meshBuilder.setMaterials(t),i._loadObj(o.obj,i.callbacks.onLoad,null,null,i.callbacks.onMeshAlter,e.useAsync)},e.crossOrigin,e.materialOptions)},n.prototype._applyPrepData=function(e){t.isValid(e)&&(this.setLogging(e.logging.enabled,e.logging.debug),this.setModelName(e.modelName),this.setStreamMeshesTo(e.streamMeshesTo),this.meshBuilder.setMaterials(e.materials),this.setUseIndices(e.useIndices),this.setDisregardNormals(e.disregardNormals),this.setMaterialPerSmoothingGroup(e.materialPerSmoothingGroup),this.setUseOAsMesh(e.useOAsMesh),this._setCallbacks(e.getCallbacks()))},n.prototype.parse=function(e){if(!t.isValid(e))return console.warn("Provided content is not a valid ArrayBuffer or String."),this.loaderRootNode;this.logging.enabled&&console.time("OBJLoader2 parse: "+this.modelName),this.meshBuilder.init();var n=new o;n.setLogging(this.logging.enabled,this.logging.debug),n.setMaterialPerSmoothingGroup(this.materialPerSmoothingGroup),n.setUseOAsMesh(this.useOAsMesh),n.setUseIndices(this.useIndices),n.setDisregardNormals(this.disregardNormals),n.setMaterials(this.meshBuilder.getMaterials());var i=this;n.setCallbackMeshBuilder(function(e){var t,n=i.meshBuilder.processPayload(e);for(var o in n)t=n[o],i.loaderRootNode.add(t)});if(n.setCallbackProgress(function(e,t){i.onProgress("progressParse",e,t)}),e instanceof ArrayBuffer||e instanceof Uint8Array)this.logging.enabled&&console.info("Parsing arrayBuffer..."),n.parse(e);else{if(!("string"==typeof e||e instanceof String))throw"Provided content was neither of type String nor Uint8Array! Aborting...";this.logging.enabled&&console.info("Parsing text..."),n.parseText(e)}return this.logging.enabled&&console.timeEnd("OBJLoader2 parse: "+this.modelName),this.loaderRootNode},n.prototype.parseAsync=function(e,n){var i=this,r=!1,s=function(){n({detail:{loaderRootNode:i.loaderRootNode,modelName:i.modelName,instanceNo:i.instanceNo}}),r&&i.logging.enabled&&console.timeEnd("OBJLoader2 parseAsync: "+i.modelName)};t.isValid(e)?r=!0:(console.warn("Provided content is not a valid ArrayBuffer."),s()),r&&this.logging.enabled&&console.time("OBJLoader2 parseAsync: "+this.modelName),this.meshBuilder.init();this.workerSupport.validate(function(e,n){var i="";return i+="/**\n",i+="  * This code was constructed by OBJLoader2 buildCode.\n",i+="  */\n\n",i+="THREE = { LoaderSupport: {} };\n\n",i+=e("LoaderSupport.Validator",t),i+=n("Parser",o)},"Parser"),this.workerSupport.setCallbacks(function(e){var t,n=i.meshBuilder.processPayload(e);for(var o in n)t=n[o],i.loaderRootNode.add(t)},s),i.terminateWorkerOnLoad&&this.workerSupport.setTerminateRequested(!0);var a={},l=this.meshBuilder.getMaterials();for(var u in l)a[u]=u;this.workerSupport.run({params:{useAsync:!0,materialPerSmoothingGroup:this.materialPerSmoothingGroup,useOAsMesh:this.useOAsMesh,useIndices:this.useIndices,disregardNormals:this.disregardNormals},logging:{enabled:this.logging.enabled,debug:this.logging.debug},materials:{materials:a},data:{input:e,options:null}})};var o=function(){function e(){this.callbackProgress=null,this.callbackMeshBuilder=null,this.contentRef=null,this.legacyMode=!1,this.materials={},this.useAsync=!1,this.materialPerSmoothingGroup=!1,this.useOAsMesh=!1,this.useIndices=!1,this.disregardNormals=!1,this.vertices=[],this.colors=[],this.normals=[],this.uvs=[],this.rawMesh={objectName:"",groupName:"",activeMtlName:"",mtllibName:"",faceType:-1,subGroups:[],subGroupInUse:null,smoothingGroup:{splitMaterials:!1,normalized:-1,real:-1},counts:{doubleIndicesCount:0,faceCount:0,mtlCount:0,smoothingGroupCount:0}},this.inputObjectCount=1,this.outputObjectCount=1,this.globalCounts={vertices:0,faces:0,doubleIndicesCount:0,lineByte:0,currentByte:0,totalBytes:0},this.logging={enabled:!0,debug:!1}}return e.prototype.resetRawMesh=function(){this.rawMesh.subGroups=[],this.rawMesh.subGroupInUse=null,this.rawMesh.smoothingGroup.normalized=-1,this.rawMesh.smoothingGroup.real=-1,this.pushSmoothingGroup(1),this.rawMesh.counts.doubleIndicesCount=0,this.rawMesh.counts.faceCount=0,this.rawMesh.counts.mtlCount=0,this.rawMesh.counts.smoothingGroupCount=0},e.prototype.setUseAsync=function(e){this.useAsync=e},e.prototype.setMaterialPerSmoothingGroup=function(e){this.materialPerSmoothingGroup=e},e.prototype.setUseOAsMesh=function(e){this.useOAsMesh=e},e.prototype.setUseIndices=function(e){this.useIndices=e},e.prototype.setDisregardNormals=function(e){this.disregardNormals=e},e.prototype.setMaterials=function(e){this.materials=me.Validator.verifyInput(e,this.materials),this.materials=me.Validator.verifyInput(this.materials,{})},e.prototype.setCallbackMeshBuilder=function(e){if(!me.Validator.isValid(e))throw'Unable to run as no "MeshBuilder" callback is set.';this.callbackMeshBuilder=e},e.prototype.setCallbackProgress=function(e){this.callbackProgress=e},e.prototype.setLogging=function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t},e.prototype.configure=function(){if(this.pushSmoothingGroup(1),this.logging.enabled){var e=Object.keys(this.materials),t="OBJLoader2.Parser configuration:"+(e.length>0?"\n\tmaterialNames:\n\t\t- "+e.join("\n\t\t- "):"\n\tmaterialNames: None")+"\n\tuseAsync: "+this.useAsync+"\n\tmaterialPerSmoothingGroup: "+this.materialPerSmoothingGroup+"\n\tuseOAsMesh: "+this.useOAsMesh+"\n\tuseIndices: "+this.useIndices+"\n\tdisregardNormals: "+this.disregardNormals+"\n\tcallbackMeshBuilderName: "+this.callbackMeshBuilder.name+"\n\tcallbackProgressName: "+this.callbackProgress.name;console.info(t)}},e.prototype.parse=function(e){this.logging.enabled&&console.time("OBJLoader2.Parser.parse"),this.configure();var t=new Uint8Array(e);this.contentRef=t;var n=t.byteLength;this.globalCounts.totalBytes=n;for(var o,i=new Array(128),r="",s=0,a=0,l=0;l<n;l++)switch(o=t[l]){case 32:r.length>0&&(i[s++]=r),r="";break;case 47:r.length>0&&(i[s++]=r),a++,r="";break;case 10:r.length>0&&(i[s++]=r),r="",this.globalCounts.lineByte=this.globalCounts.currentByte,this.globalCounts.currentByte=l,this.processLine(i,s,a),s=0,a=0;break;case 13:break;default:r+=String.fromCharCode(o)}this.finalizeParsing(),this.logging.enabled&&console.timeEnd("OBJLoader2.Parser.parse")},e.prototype.parseText=function(e){this.logging.enabled&&console.time("OBJLoader2.Parser.parseText"),this.configure(),this.legacyMode=!0,this.contentRef=e;var t=e.length;this.globalCounts.totalBytes=t;for(var n,o=new Array(128),i="",r=0,s=0,a=0;a<t;a++)switch(n=e[a]){case" ":i.length>0&&(o[r++]=i),i="";break;case"/":i.length>0&&(o[r++]=i),s++,i="";break;case"\n":i.length>0&&(o[r++]=i),i="",this.globalCounts.lineByte=this.globalCounts.currentByte,this.globalCounts.currentByte=a,this.processLine(o,r,s),r=0,s=0;break;case"\r":break;default:i+=n}this.finalizeParsing(),this.logging.enabled&&console.timeEnd("OBJLoader2.Parser.parseText")},e.prototype.processLine=function(e,t,n){if(!(t<1)){var o,i,r,s,a=function(e,t,n,o){var i="";if(o>n){var r;if(t)for(r=n;r<o;r++)i+=e[r];else for(r=n;r<o;r++)i+=String.fromCharCode(e[r]);i=i.trim()}return i};switch(s=e[0]){case"v":this.vertices.push(parseFloat(e[1])),this.vertices.push(parseFloat(e[2])),this.vertices.push(parseFloat(e[3])),t>4&&(this.colors.push(parseFloat(e[4])),this.colors.push(parseFloat(e[5])),this.colors.push(parseFloat(e[6])));break;case"vt":this.uvs.push(parseFloat(e[1])),this.uvs.push(parseFloat(e[2]));break;case"vn":this.normals.push(parseFloat(e[1])),this.normals.push(parseFloat(e[2])),this.normals.push(parseFloat(e[3]));break;case"f":if(o=t-1,0===n)for(this.checkFaceType(0),r=2,i=o;r<i;r++)this.buildFace(e[1]),this.buildFace(e[r]),this.buildFace(e[r+1]);else if(o===2*n)for(this.checkFaceType(1),r=3,i=o-2;r<i;r+=2)this.buildFace(e[1],e[2]),this.buildFace(e[r],e[r+1]),this.buildFace(e[r+2],e[r+3]);else if(2*o==3*n)for(this.checkFaceType(2),r=4,i=o-3;r<i;r+=3)this.buildFace(e[1],e[2],e[3]),this.buildFace(e[r],e[r+1],e[r+2]),this.buildFace(e[r+3],e[r+4],e[r+5]);else for(this.checkFaceType(3),r=3,i=o-2;r<i;r+=2)this.buildFace(e[1],void 0,e[2]),this.buildFace(e[r],void 0,e[r+1]),this.buildFace(e[r+2],void 0,e[r+3]);break;case"l":case"p":if((o=t-1)===2*n)for(this.checkFaceType(4),r=1,i=o+1;r<i;r+=2)this.buildFace(e[r],e[r+1]);else for(this.checkFaceType("l"===s?5:6),r=1,i=o+1;r<i;r++)this.buildFace(e[r]);break;case"s":this.pushSmoothingGroup(e[1]);break;case"g":this.processCompletedMesh(),this.rawMesh.groupName=a(this.contentRef,this.legacyMode,this.globalCounts.lineByte+2,this.globalCounts.currentByte);break;case"o":this.useOAsMesh&&this.processCompletedMesh(),this.rawMesh.objectName=a(this.contentRef,this.legacyMode,this.globalCounts.lineByte+2,this.globalCounts.currentByte);break;case"mtllib":this.rawMesh.mtllibName=a(this.contentRef,this.legacyMode,this.globalCounts.lineByte+7,this.globalCounts.currentByte);break;case"usemtl":var l=a(this.contentRef,this.legacyMode,this.globalCounts.lineByte+7,this.globalCounts.currentByte);""!==l&&this.rawMesh.activeMtlName!==l&&(this.rawMesh.activeMtlName=l,this.rawMesh.counts.mtlCount++,this.checkSubGroup())}}},e.prototype.pushSmoothingGroup=function(e){var t=parseInt(e);isNaN(t)&&(t="off"===e?0:1);var n=this.rawMesh.smoothingGroup.normalized;this.rawMesh.smoothingGroup.normalized=this.rawMesh.smoothingGroup.splitMaterials?t:0===t?0:1,this.rawMesh.smoothingGroup.real=t,n!==t&&(this.rawMesh.counts.smoothingGroupCount++,this.checkSubGroup())},e.prototype.checkFaceType=function(e){this.rawMesh.faceType!==e&&(this.processCompletedMesh(),this.rawMesh.faceType=e,this.checkSubGroup())},e.prototype.checkSubGroup=function(){var e=this.rawMesh.activeMtlName+"|"+this.rawMesh.smoothingGroup.normalized;this.rawMesh.subGroupInUse=this.rawMesh.subGroups[e],me.Validator.isValid(this.rawMesh.subGroupInUse)||(this.rawMesh.subGroupInUse={index:e,objectName:this.rawMesh.objectName,groupName:this.rawMesh.groupName,materialName:this.rawMesh.activeMtlName,smoothingGroup:this.rawMesh.smoothingGroup.normalized,vertices:[],indexMappingsCount:0,indexMappings:[],indices:[],colors:[],uvs:[],normals:[]},this.rawMesh.subGroups[e]=this.rawMesh.subGroupInUse)},e.prototype.buildFace=function(e,t,n){this.disregardNormals&&(n=void 0);var o=this,i=function(){var i=parseInt(e),r=3*(i>0?i-1:i+o.vertices.length/3),s=o.rawMesh.subGroupInUse.vertices;s.push(o.vertices[r++]),s.push(o.vertices[r++]),s.push(o.vertices[r]);var a=o.colors.length>0?r+1:null;if(null!==a){var l=o.rawMesh.subGroupInUse.colors;l.push(o.colors[a++]),l.push(o.colors[a++]),l.push(o.colors[a])}if(t){var u=parseInt(t),c=2*(u>0?u-1:u+o.uvs.length/2),d=o.rawMesh.subGroupInUse.uvs;d.push(o.uvs[c++]),d.push(o.uvs[c])}if(n){var h=parseInt(n),p=3*(h>0?h-1:h+o.normals.length/3),f=o.rawMesh.subGroupInUse.normals;f.push(o.normals[p++]),f.push(o.normals[p++]),f.push(o.normals[p])}};if(this.useIndices){var r=e+(t?"_"+t:"_n")+(n?"_"+n:"_n"),s=this.rawMesh.subGroupInUse.indexMappings[r];me.Validator.isValid(s)?this.rawMesh.counts.doubleIndicesCount++:(s=this.rawMesh.subGroupInUse.vertices.length/3,i(),this.rawMesh.subGroupInUse.indexMappings[r]=s,this.rawMesh.subGroupInUse.indexMappingsCount++),this.rawMesh.subGroupInUse.indices.push(s)}else i();this.rawMesh.counts.faceCount++},e.prototype.createRawMeshReport=function(e){return"Input Object number: "+e+"\n\tObject name: "+this.rawMesh.objectName+"\n\tGroup name: "+this.rawMesh.groupName+"\n\tMtllib name: "+this.rawMesh.mtllibName+"\n\tVertex count: "+this.vertices.length/3+"\n\tNormal count: "+this.normals.length/3+"\n\tUV count: "+this.uvs.length/2+"\n\tSmoothingGroup count: "+this.rawMesh.counts.smoothingGroupCount+"\n\tMaterial count: "+this.rawMesh.counts.mtlCount+"\n\tReal MeshOutputGroup count: "+this.rawMesh.subGroups.length},e.prototype.finalizeRawMesh=function(){var e,t,n=[],o=0,i=0,r=0,s=0,a=0,l=0;for(var u in this.rawMesh.subGroups)if((e=this.rawMesh.subGroups[u]).vertices.length>0){if((t=e.indices).length>0&&i>0)for(var c in t)t[c]=t[c]+i;n.push(e),o+=e.vertices.length,i+=e.indexMappingsCount,r+=e.indices.length,s+=e.colors.length,l+=e.uvs.length,a+=e.normals.length}var d=null;return n.length>0&&(d={name:""!==this.rawMesh.groupName?this.rawMesh.groupName:this.rawMesh.objectName,subGroups:n,absoluteVertexCount:o,absoluteIndexCount:r,absoluteColorCount:s,absoluteNormalCount:a,absoluteUvCount:l,faceCount:this.rawMesh.counts.faceCount,doubleIndicesCount:this.rawMesh.counts.doubleIndicesCount}),d},e.prototype.processCompletedMesh=function(){var e=this.finalizeRawMesh();if(me.Validator.isValid(e)){if(this.colors.length>0&&this.colors.length!==this.vertices.length)throw"Vertex Colors were detected, but vertex count and color count do not match!";this.logging.enabled&&this.logging.debug&&console.debug(this.createRawMeshReport(this.inputObjectCount)),this.inputObjectCount++,this.buildMesh(e);var t=this.globalCounts.currentByte/this.globalCounts.totalBytes;return this.callbackProgress("Completed [o: "+this.rawMesh.objectName+" g:"+this.rawMesh.groupName+"] Total progress: "+(100*t).toFixed(2)+"%",t),this.resetRawMesh(),!0}return!1},e.prototype.buildMesh=function(e){var t=e.subGroups,n=new Float32Array(e.absoluteVertexCount);this.globalCounts.vertices+=e.absoluteVertexCount/3,this.globalCounts.faces+=e.faceCount,this.globalCounts.doubleIndicesCount+=e.doubleIndicesCount;var o,i,r,s,a,l,u,c=e.absoluteIndexCount>0?new Uint32Array(e.absoluteIndexCount):null,d=e.absoluteColorCount>0?new Float32Array(e.absoluteColorCount):null,h=e.absoluteNormalCount>0?new Float32Array(e.absoluteNormalCount):null,p=e.absoluteUvCount>0?new Float32Array(e.absoluteUvCount):null,f=me.Validator.isValid(d),g=[],m=t.length>1,b=0,_=[],v=[],y=0,w=0,k=0,x=0,C=0,E=0,M=0;for(var A in t)if(t.hasOwnProperty(A)){if(u=(o=t[A]).materialName,l=this.rawMesh.faceType<4?u+(f?"_vertexColor":"")+(0===o.smoothingGroup?"_flat":""):6===this.rawMesh.faceType?"defaultPointMaterial":"defaultLineMaterial",s=this.materials[u],a=this.materials[l],!me.Validator.isValid(s)&&!me.Validator.isValid(a)){var O=f?"defaultVertexColorMaterial":"defaultMaterial";s=this.materials[O],this.logging.enabled&&console.warn('object_group "'+o.objectName+"_"+o.groupName+'" was defined with unresolvable material "'+u+'"! Assigning "'+O+'".'),(u=O)===l&&(a=s,l=O)}if(!me.Validator.isValid(a)){var S={materialNameOrg:u,materialName:l,materialProperties:{vertexColors:f?2:0,flatShading:0===o.smoothingGroup}},L={cmd:"materialData",materials:{materialCloneInstructions:S}};this.callbackMeshBuilder(L),this.useAsync&&(this.materials[l]=S)}if(m?((i=_[l])||(i=b,_[l]=b,g.push(l),b++),r={start:E,count:M=this.useIndices?o.indices.length:o.vertices.length/3,index:i},v.push(r),E+=M):g.push(l),n.set(o.vertices,y),y+=o.vertices.length,c&&(c.set(o.indices,w),w+=o.indices.length),d&&(d.set(o.colors,k),k+=o.colors.length),h&&(h.set(o.normals,x),x+=o.normals.length),p&&(p.set(o.uvs,C),C+=o.uvs.length),this.logging.enabled&&this.logging.debug){var R=me.Validator.isValid(i)?"\n\t\tmaterialIndex: "+i:"",T="\tOutput Object no.: "+this.outputObjectCount+"\n\t\tgroupName: "+o.groupName+"\n\t\tIndex: "+o.index+"\n\t\tfaceType: "+this.rawMesh.faceType+"\n\t\tmaterialName: "+o.materialName+"\n\t\tsmoothingGroup: "+o.smoothingGroup+R+"\n\t\tobjectName: "+o.objectName+"\n\t\t#vertices: "+o.vertices.length/3+"\n\t\t#indices: "+o.indices.length+"\n\t\t#colors: "+o.colors.length/3+"\n\t\t#uvs: "+o.uvs.length/2+"\n\t\t#normals: "+o.normals.length/3;console.debug(T)}}this.outputObjectCount++,this.callbackMeshBuilder({cmd:"meshData",progress:{numericalValue:this.globalCounts.currentByte/this.globalCounts.totalBytes},params:{meshName:e.name},materials:{multiMaterial:m,materialNames:g,materialGroups:v},buffers:{vertices:n,indices:c,colors:d,normals:h,uvs:p},geometryType:this.rawMesh.faceType<4?0:6===this.rawMesh.faceType?2:1},[n.buffer],me.Validator.isValid(c)?[c.buffer]:null,me.Validator.isValid(d)?[d.buffer]:null,me.Validator.isValid(h)?[h.buffer]:null,me.Validator.isValid(p)?[p.buffer]:null)},e.prototype.finalizeParsing=function(){if(this.logging.enabled&&console.info("Global output object count: "+this.outputObjectCount),this.processCompletedMesh()&&this.logging.enabled){var e="Overall counts: \n\tVertices: "+this.globalCounts.vertices+"\n\tFaces: "+this.globalCounts.faces+"\n\tMultiple definitions: "+this.globalCounts.doubleIndicesCount;console.info(e)}},e}();return n.prototype.loadMtl=function(e,t,n,o,i){var r=new me.ResourceDescriptor(e,"MTL");r.setContent(t),this._loadMtl(r,n,o,i)},n.prototype._loadMtl=function(e,n,o,i){void 0===_e&&console.error('"MTLLoader" is not available. "OBJLoader2" requires it for loading MTL files.'),t.isValid(e)&&this.logging.enabled&&console.time("Loading MTL: "+e.name);var r=[],s=this,a=function(o){var i=[];if(t.isValid(o))for(var a in o.preload(),i=o.materials)i.hasOwnProperty(a)&&(r[a]=i[a]);t.isValid(e)&&s.logging.enabled&&console.timeEnd("Loading MTL: "+e.name),n(r,o)};if(t.isValid(e)&&(t.isValid(e.content)||t.isValid(e.url))){var l=new _e(this.manager);o=t.verifyInput(o,"anonymous"),l.setCrossOrigin(o),l.setPath(e.path),t.isValid(i)&&l.setMaterialOptions(i);var u=function(e){var t=e;if("string"!=typeof e&&!(e instanceof String)){if(!(e.length>0||e.byteLength>0))throw"Unable to parse mtl as it it seems to be neither a String, an Array or an ArrayBuffer!";t=THREE.LoaderUtils.decodeText(e)}a(l.parse(t))};if(t.isValid(e.content))u(e.content);else if(t.isValid(e.url)){new THREE.FileLoader(this.manager).load(e.url,u,this._onProgress,this._onError)}}else a()},n}(),ye=n(4),we=n.n(ye);let ke=Object.assign({},THREE,{OBJLoader2:ve,seedrandom:we.a}),xe=null,Ce=[],Ee="";const Me=n(8);var Ae,Oe=!1,Se=!1,Le=!1,Re=!1,Te=!1,Pe=!1,Ne=performance.now(),Ve=new THREE.Vector3,Be=new THREE.Vector3;let je=new THREE.Vector3,Ie=new THREE.Vector3;var Fe,He,De,ze,Ge={init:function(e){var t=document.getElementById("blocker"),n=document.getElementById("instructions");if("pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document){var o=document.body,i=function(i){document.pointerLockElement===o||document.mozPointerLockElement===o||document.webkitPointerLockElement===o?(e.enabled=!0,t.style.display="none"):(e.enabled=!1,t.style.display="block",n.style.display="")},r=function(e){n.style.display=""};document.addEventListener("pointerlockchange",i,!1),document.addEventListener("mozpointerlockchange",i,!1),document.addEventListener("webkitpointerlockchange",i,!1),document.addEventListener("pointerlockerror",r,!1),document.addEventListener("mozpointerlockerror",r,!1),document.addEventListener("webkitpointerlockerror",r,!1),o.addEventListener("click",function e(){o.requestPointerLock(),o.removeEventListener("click",e)}),n.addEventListener("click",function(e){n.style.display="none",o.requestPointerLock=o.requestPointerLock||o.mozRequestPointerLock||o.webkitRequestPointerLock,o.requestPointerLock()},!1)}else n.innerHTML="Your browser doesn't seem to support Pointer Lock API"}},Ue=n(3),We=n.n(Ue);new Promise(function(e){fe("src/universe_parts/mapping.js","defineThreeUniverse",t=>t().then(t=>{xe=t.maping,Ee=t.local_part;let n=xe.filter(e=>e.url.startsWith(Ee));n.length&&(t.local_position=n[0].position),e(t)}))}).then(e=>{let t=new THREE.Vector3,n=new THREE.Vector3(0,100,0),o=function(){let e=window.location.hash.substr(1).split("&"),t={};if(e.forEach(e=>{let n=e.split(":");t[n[0]]=n[1]}),e.length<=1)return null;function n(e){t[e]?t[e]=Number(t[e]):t[e]=0}return n("x"),n("y"),n("z"),t}();if(o)t.set(n.x+o.x,n.y+o.y,n.z+o.z);else{let o=localStorage.getItem("lastCameraPosition");if(o&&"undefined"!==o){let e=JSON.parse(o);t.set(n.x+e.x,n.y+e.y,n.z+e.z)}else{let o=e.local_position;["x","y","z"].forEach(e=>{o[e]?o[e]=Number(o[e]):o[e]=0}),o&&t.set(n.x+o.x,n.y+o.y,n.z+o.z)}}!function(e){Fe=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,2e3),(He=new THREE.Scene).background=new THREE.Color(13426943),He.fog=new THREE.Fog(13426943,500,1800),le.add(He.fog,"near",0,100).name("fog near"),le.add(He.fog,"far",10,1e4).name("fog far"),le.close(),le.add(Fe,"far",100,1e4).name("Camera far").onChange(e=>{Fe.updateProjectionMatrix()}),ze=function(e,t){return Ae=new Me(e),document.addEventListener("keydown",function(e){switch(e.keyCode){case 38:case 87:Oe=!0;break;case 37:case 65:Le=!0;break;case 66:Pe=!0;break;case 40:case 83:Se=!0;break;case 39:case 68:Re=!0;break;case 32:!0===Te&&(Ve.y+=350),Te=!1}},!1),document.addEventListener("keyup",function(e){switch(e.keyCode){case 38:case 87:Oe=!1;break;case 37:case 65:Le=!1;break;case 40:case 83:Se=!1;break;case 39:case 68:Re=!1;break;case 66:Pe=!1}},!1),Ae}(Fe),He.add(ze.getObject()),Fe.position.y=100,ze.getObject().translateX(e.x),ze.getObject().translateZ(e.z),Ge.init(ze);var t=new THREE.AmbientLight(4210752);He.add(t),(De=new THREE.WebGLRenderer({antialias:!0})).shadowMap.enabled=!0,De.shadowMap.type=THREE.PCFShadowMap,De.setPixelRatio(window.devicePixelRatio),De.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(De.domElement),Object(ue.initVisibilityDesider)(De.info),window.addEventListener("resize",Je,!1)}(t),Ye()});var qe=!0;function Qe(){qe=!0}var Xe=!0;function Je(){Fe.aspect=window.innerWidth/window.innerHeight,Fe.updateProjectionMatrix(),Qe(),De.setSize(window.innerWidth,window.innerHeight)}function Ye(){requestAnimationFrame(Ye),qe&&(De.render(He,Fe),qe=!1,function(e){for(let t=Ce.length-1;t>-1;t--)Ce[t].onCameraUpdate&&Ce[t].onCameraUpdate(e)}(ze.getObject().position)),(!0===ze.enabled||Xe)&&(function(e){var t=performance.now(),n=(t-Ne)/1e3;Ve.x-=10*Ve.x*n,Ve.z-=10*Ve.z*n,Ve.y-=9.8*100*n,Be.z=Number(Oe)-Number(Se),Be.x=Number(Le)-Number(Re),Be.normalize();let o=1e3;Pe&&(o=4e3),(Oe||Se)&&(Ve.z-=Be.z*o*n),(Le||Re)&&(Ve.x-=Be.x*o*n),!0===e&&(Ve.y=Math.max(0,Ve.y),Te=!0),Ae.getObject().translateX(Ve.x*n),Ae.getObject().translateY(Ve.y*n),Ae.getObject().translateZ(Ve.z*n),Ae.getObject().position.y<10&&(Ve.y=0,Ae.getObject().position.y=10,Te=!0),Ne=t;let i=!1,r=je.distanceTo(Ae.getObject().position),s=(new THREE.Vector3).subVectors(new THREE.Vector3(Ae.getObject().rotation.x,Ae.getObject().rotation.y,Ae.getObject().rotation.z),new THREE.Vector3(Ie.x,Ie.y,Ie.z));return(r>Number.EPSILON||Math.abs(s.x)>Number.EPSILON||Math.abs(s.y)>Number.EPSILON||Math.abs(s.z)>Number.EPSILON)&&(i=!0),je=Ae.getObject().position.clone(),Ie=Ae.getObject().rotation.clone(),i}(!1)&&(!function e(t){e.frameCount||(e.frameCount=0);0==e.frameCount&&(function(e,t,n,o){xe.forEach(i=>{if(!Ce.includes(i)){let r=new THREE.Vector3(i.position.x,i.position.y,i.position.z);if(r.distanceTo(e)-i.radius<t){let e=new THREE.Object3D;e.position.copy(r);let t=i.url.substring(0,i.url.indexOf("src/universe_parts"));t==Ee&&(i.url=i.url.substring(Ee.length)),fe(i.url,"defineThreeUniverse",r=>{i.disposer=null,r(ke,{dispose:function(e){i.disposer=e},onCameraUpdate:function(e){i.onCameraUpdate=e},baseUrl:t}).then(t=>{e.add(t),n.add(e),i.object=e,o()})}),Ce.push(i)}}})}(t,Fe.far,He,Qe),function(e,t,n,o){let i=[];Ce.forEach(n=>{new THREE.Vector3(n.position.x,n.position.y,n.position.z).distanceTo(e)-n.radius>t+100&&n.object&&(console.log("Unloading ",n.url),n.object.parent.remove(n.object),n.disposer?n.disposer():n.object.traverse(function(e){e.isMesh&&(e.geometry&&e.geometry.dispose(),e.material&&(e.material.map&&e.material.map.dispose(),e.material.dispose()))}),i.push(n))}),i.forEach(e=>{let t=Ce.indexOf(e);-1!=t&&Ce.splice(t,1)})}(t,Fe.far));59==e.frameCount&&(localStorage.setItem("lastCameraPosition",JSON.stringify(t)),localStorage.setItem("lastCameraRotation",JSON.stringify(ze.getObject().rotation)),We()(`x:${ze.getObject().position.x.toFixed(0)}&z:${ze.getObject().position.z.toFixed(0)}`,{replace:!0}));e.frameCount<60?e.frameCount++:e.frameCount=0}(ze.getObject().position),Qe()),Xe=!1)}},function(e,t){e.exports=function(e){var t=window.THREE,n=this;e.rotation.set(0,0,0);var o=new t.Object3D;o.add(e);var i=new t.Object3D;i.position.y=10,i.add(o);var r,s,a=!1,l=!1,u=!1,c=!1,d=!1,h=!1,p=performance.now(),f=new t.Vector3,g=Math.PI/2;document.addEventListener("mousemove",function(e){if(!1!==n.enabled){var t=e.movementX||e.mozMovementX||e.webkitMovementX||0,r=e.movementY||e.mozMovementY||e.webkitMovementY||0;i.rotation.y-=.002*t,o.rotation.x-=.002*r,o.rotation.x=Math.max(-g,Math.min(g,o.rotation.x))}},!1),document.addEventListener("keydown",function(e){switch(e.keyCode){case 38:case 87:a=!0;break;case 37:case 65:u=!0;break;case 40:case 83:l=!0;break;case 39:case 68:c=!0;break;case 32:!0===h&&(f.y+=350),h=!1}},!1),document.addEventListener("keyup",function(e){switch(e.keyCode){case 38:case 87:a=!1;break;case 37:case 65:u=!1;break;case 40:case 83:l=!1;break;case 39:case 68:c=!1}},!1),this.enabled=!1,this.getObject=function(){return i},this.isOnObject=function(e){d=e,h=e},this.getDirection=(r=new t.Vector3(0,0,-1),s=new t.Euler(0,0,0,"YXZ"),function(e){return s.set(o.rotation.x,i.rotation.y,0),e.copy(r).applyEuler(s),e}),this.update=function(){if(!1!==n.enabled){var e=performance.now(),t=(e-p)/1e3;f.x-=10*f.x*t,f.z-=10*f.z*t,f.y-=9.8*100*t,a&&(f.z-=400*t),l&&(f.z+=400*t),u&&(f.x-=400*t),c&&(f.x+=400*t),!0===d&&(f.y=Math.max(0,f.y)),i.translateX(f.x*t),i.translateY(f.y*t),i.translateZ(f.z*t),i.position.y<10&&(f.y=0,i.position.y=10,h=!0),p=e}}}},function(e,t){},function(e,t,n){var o;!function(i,r){var s,a=this,l=256,u=6,c="random",d=r.pow(l,u),h=r.pow(2,52),p=2*h,f=l-1;function g(e,t,n){var o=[],g=b(function e(t,n){var o,i=[],r=typeof t;if(n&&"object"==r)for(o in t)try{i.push(e(t[o],n-1))}catch(e){}return i.length?i:"string"==r?t:t+"\0"}((t=1==t?{entropy:!0}:t||{}).entropy?[e,_(i)]:null==e?function(){try{var e;return s&&(e=s.randomBytes)?e=e(l):(e=new Uint8Array(l),(a.crypto||a.msCrypto).getRandomValues(e)),_(e)}catch(e){var t=a.navigator,n=t&&t.plugins;return[+new Date,a,n,a.screen,_(i)]}}():e,3),o),v=new function(e){var t,n=e.length,o=this,i=0,r=o.i=o.j=0,s=o.S=[];n||(e=[n++]);for(;i<l;)s[i]=i++;for(i=0;i<l;i++)s[i]=s[r=f&r+e[i%n]+(t=s[i])],s[r]=t;(o.g=function(e){for(var t,n=0,i=o.i,r=o.j,s=o.S;e--;)t=s[i=f&i+1],n=n*l+s[f&(s[i]=s[r=f&r+t])+(s[r]=t)];return o.i=i,o.j=r,n})(l)}(o),y=function(){for(var e=v.g(u),t=d,n=0;e<h;)e=(e+n)*l,t*=l,n=v.g(1);for(;e>=p;)e/=2,t/=2,n>>>=1;return(e+n)/t};return y.int32=function(){return 0|v.g(4)},y.quick=function(){return v.g(4)/4294967296},y.double=y,b(_(v.S),i),(t.pass||n||function(e,t,n,o){return o&&(o.S&&m(o,v),e.state=function(){return m(v,{})}),n?(r[c]=e,t):e})(y,g,"global"in t?t.global:this==r,t.state)}function m(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function b(e,t){for(var n,o=e+"",i=0;i<o.length;)t[f&i]=f&(n^=19*t[f&i])+o.charCodeAt(i++);return _(t)}function _(e){return String.fromCharCode.apply(0,e)}if(r["seed"+c]=g,b(r.random(),i),"object"==typeof e&&e.exports){e.exports=g;try{s=n(9)}catch(e){}}else void 0===(o=function(){return g}.call(t,n,t,e))||(e.exports=o)}([],Math)},function(e,t,n){(function(e){var o;!function(e,i,r){function s(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function a(e,t){var n=new function(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,o=t.d,i=t.a;return e=e<<25^e>>>7^n,n=n-o|0,o=o<<24^o>>>8^i,i=i-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-o|0,t.d=o<<16^n>>>16^i,t.a=i-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var o=0;o<n.length+20;o++)t.b^=0|n.charCodeAt(o),t.next()}(e),o=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,o&&("object"==typeof o&&s(o,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=a:n(0)&&n(1)?void 0===(o=function(){return a}.call(t,n,t,i))||(i.exports=o):this.tychei=a}(0,"object"==typeof e&&e,n(0))}).call(this,n(2)(e))},function(e,t,n){(function(e){var o;!function(e,i,r){function s(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function a(e,t){null==e&&(e=+new Date);var n=new function(e){var t=this;t.next=function(){var e,n,o=t.w,i=t.X,r=t.i;return t.w=o=o+1640531527|0,n=i[r+34&127],e=i[r=r+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=i[r]=n^e,t.i=r,n+(o^o>>>16)|0},function(e,t){var n,o,i,r,s,a=[],l=128;for(t===(0|t)?(o=t,t=null):(t+="\0",o=0,l=Math.max(l,t.length)),i=0,r=-32;r<l;++r)t&&(o^=t.charCodeAt((r+32)%t.length)),0===r&&(s=o),o^=o<<10,o^=o>>>15,o^=o<<4,o^=o>>>13,r>=0&&(s=s+1640531527|0,i=0==(n=a[127&r]^=o+s)?i+1:0);for(i>=128&&(a[127&(t&&t.length||0)]=-1),i=127,r=512;r>0;--r)o=a[i+34&127],n=a[i=i+1&127],o^=o<<13,n^=n<<17,o^=o>>>15,n^=n>>>12,a[i]=o^n;e.w=s,e.X=a,e.i=i}(t,e)}(e),o=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,o&&(o.X&&s(o,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=a:n(0)&&n(1)?void 0===(o=function(){return a}.call(t,n,t,i))||(i.exports=o):this.xor4096=a}(0,"object"==typeof e&&e,n(0))}).call(this,n(2)(e))},function(e,t,n){(function(e){var o;!function(e,i,r){function s(e,t){return t.x=e.x.slice(),t.i=e.i,t}function a(e,t){null==e&&(e=+new Date);var n=new function(e){var t=this;t.next=function(){var e,n,o=t.x,i=t.i;return e=o[i],n=(e^=e>>>7)^e<<24,n^=(e=o[i+1&7])^e>>>10,n^=(e=o[i+3&7])^e>>>3,n^=(e=o[i+4&7])^e<<7,e=o[i+7&7],n^=(e^=e<<13)^e<<9,o[i]=n,t.i=i+1&7,n},function(e,t){var n,o=[];if(t===(0|t))o[0]=t;else for(t=""+t,n=0;n<t.length;++n)o[7&n]=o[7&n]<<15^t.charCodeAt(n)+o[n+1&7]<<13;for(;o.length<8;)o.push(0);for(n=0;n<8&&0===o[n];++n);for(8==n?o[7]=-1:o[n],e.x=o,e.i=0,n=256;n>0;--n)e.next()}(t,e)}(e),o=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,o&&(o.x&&s(o,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=a:n(0)&&n(1)?void 0===(o=function(){return a}.call(t,n,t,i))||(i.exports=o):this.xorshift7=a}(0,"object"==typeof e&&e,n(0))}).call(this,n(2)(e))},function(e,t,n){(function(e){var o;!function(e,i,r){function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function a(e,t){var n=new function(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var o=0;o<n.length+64;o++)t.x^=0|n.charCodeAt(o),o==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}(e),o=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,o&&("object"==typeof o&&s(o,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=a:n(0)&&n(1)?void 0===(o=function(){return a}.call(t,n,t,i))||(i.exports=o):this.xorwow=a}(0,"object"==typeof e&&e,n(0))}).call(this,n(2)(e))},function(e,t,n){(function(e){var o;!function(e,i,r){function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function a(e,t){var n=new function(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var o=0;o<n.length+64;o++)t.x^=0|n.charCodeAt(o),t.next()}(e),o=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,o&&("object"==typeof o&&s(o,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=a:n(0)&&n(1)?void 0===(o=function(){return a}.call(t,n,t,i))||(i.exports=o):this.xor128=a}(0,"object"==typeof e&&e,n(0))}).call(this,n(2)(e))},function(e,t,n){(function(e){var o;!function(e,i,r){function s(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function a(e,t){var n=new function(e){var t,n=this,o=(t=4022871197,function(e){e=e.toString();for(var n=0;n<e.length;n++){var o=.02519603282416938*(t+=e.charCodeAt(n));o-=t=o>>>0,t=(o*=t)>>>0,t+=4294967296*(o-=t)}return 2.3283064365386963e-10*(t>>>0)});n.next=function(){var e=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=e-(n.c=0|e)},n.c=1,n.s0=o(" "),n.s1=o(" "),n.s2=o(" "),n.s0-=o(e),n.s0<0&&(n.s0+=1),n.s1-=o(e),n.s1<0&&(n.s1+=1),n.s2-=o(e),n.s2<0&&(n.s2+=1),o=null}(e),o=t&&t.state,i=n.next;return i.int32=function(){return 4294967296*n.next()|0},i.double=function(){return i()+1.1102230246251565e-16*(2097152*i()|0)},i.quick=i,o&&("object"==typeof o&&s(o,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=a:n(0)&&n(1)?void 0===(o=function(){return a}.call(t,n,t,i))||(i.exports=o):this.alea=a}(0,"object"==typeof e&&e,n(0))}).call(this,n(2)(e))}])});